# GoGymi Challenge Mode

# Konzept & Design

## 1. Produkt-Vision

### One-Liner

> "Tinder fÃ¼r GymiprÃ¼fungs-Aufgaben â€“ swipe, lÃ¶se, challenge."
> 

### Ziele

| Ziel | Metrik | Target |
| --- | --- | --- |
| **Virale Akquise** | Invite-to-Registration Rate | 40% |
| **Engagement** | Aufgaben pro Session | 3+ |
| **Conversion** | Email-Capture Rate | 25% |
| **Upselling** | Free â†’ Abo Conversion | 8% |
| **PR** | Medien-Embeds pro Saison | 5+ |

### Kernprinzipien

1. **Instant Gratification**: Erste Aufgabe in <10 Sekunden lÃ¶sbar
2. **Progressive Disclosure**: Wert zeigen, bevor wir etwas verlangen
3. **Social by Default**: Teilen/Challengen ist der natÃ¼rliche nÃ¤chste Schritt
4. **Mobile First**: 70% der Zielgruppe nutzt Smartphones

---

## 2. User Personas

### Persona A: "Der Neugierige Leser" (Akquise)

```
ðŸ‘¤ Thomas, 42, Vater
ðŸ“ Liest Zeitungs-Artikel Ã¼ber GymiprÃ¼fung
ðŸ’­ "KÃ¶nnte ich das noch? Mal schauen..."
ðŸŽ¯ Ziel: Nostalgie, Selbsttest
âš¡ Trigger: Embed im Artikel

```

### Persona B: "Die Ehrgeizige SchÃ¼lerin" (Retention)

```
ðŸ‘¤ Lara, 11, 6. Klasse
ðŸ“ Bereitet sich auf ZAP vor
ðŸ’­ "Ich will wissen, wo ich stehe"
ðŸŽ¯ Ziel: Ãœben, Vergleich mit anderen
âš¡ Trigger: Challenge von Freundin

```

### Persona C: "Der Competitive Gamer" (Engagement)

```
ðŸ‘¤ Nico, 12, 6. Klasse
ðŸ“ Spielt gerne Kahoot in der Schule
ðŸ’­ "Ich will gewinnen!"
ðŸŽ¯ Ziel: Leaderboard, Badges
âš¡ Trigger: "Nur 12% schaffen das"

```

### Persona D: "Die Besorgte Mutter" (Conversion)

```
ðŸ‘¤ Sandra, 45, Mutter von Lara
ðŸ“ Sucht VorbereitungsmÃ¶glichkeiten
ðŸ’­ "Ist mein Kind bereit?"
ðŸŽ¯ Ziel: EinschÃ¤tzung, dann Abo
âš¡ Trigger: Sieht Laras Ergebnisse

```

---

## 3. Core Mechanics

### 3.1 Spielmodi

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚   âš¡ QUICK CHALLENGE          ðŸŽ¯ DUELL               ðŸ† PRÃœFUNG  â”‚
â”‚    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                                                                 â”‚
â”‚   1 Aufgabe                  1 Aufgabe            12 Aufgaben   â”‚
â”‚   Solo                       vs. Freund           Komplette     â”‚
â”‚   ~60 Sekunden               Async                PrÃ¼fung       â”‚
â”‚                                                                 â”‚
â”‚   [Ã–ffentlich]               [Email nÃ¶tig]        [Abo nÃ¶tig]   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 3.2 Aufgaben-Selektion

```
FILTER-OPTIONEN:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  Stufe:     [Langzeit â–¼]    [Kurzzeit]                          â”‚
â”‚                                                                 â”‚
â”‚  Fach:      [Mathe â–¼]       [Deutsch]                           â”‚
â”‚                                                                 â”‚
â”‚  Thema:     [Alle â–¼]                                            â”‚
â”‚             â”œâ”€â”€ ProportionalitÃ¤t                                â”‚
â”‚             â”œâ”€â”€ Textaufgaben                                    â”‚
â”‚             â”œâ”€â”€ Geometrie                                       â”‚
â”‚             â”œâ”€â”€ BrÃ¼che                                          â”‚
â”‚             â””â”€â”€ ...                                             â”‚
â”‚                                                                 â”‚
â”‚  Schwierigkeit:  [â­ Einfach]  [â­â­ Mittel]  [â­â­â­ Schwer]    â”‚
â”‚                                                                 â”‚
â”‚  ODER:      [ðŸŽ² ZufÃ¤llige Aufgabe]                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 3.3 Punkte-System

| Aktion | Punkte | Bonus |
| --- | --- | --- |
| Richtige Antwort | 100 | - |
| Schneller als Durchschnitt | +50 | - |
| Top 10% Zeit | +100 | "Blitz-Bonus" |
| Streak (3 richtig) | +50 | "Streak x3" |
| Streak (5 richtig) | +100 | "On Fire ðŸ”¥" |
| Streak (10 richtig) | +200 | "Unstoppable" |
| Duell gewonnen | +150 | - |
| Freund eingeladen (accepted) | +200 | - |

### 3.4 Level-System

```
LEVEL-PROGRESSION:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚  Level 1    "AnfÃ¤nger"           0 - 500 XP         ðŸ¥‰          â”‚
â”‚  Level 2    "Aufsteiger"         500 - 1500 XP      ðŸ¥‰          â”‚
â”‚  Level 3    "ProblemlÃ¶ser"       1500 - 3000 XP     ðŸ¥ˆ          â”‚
â”‚  Level 4    "Mathe-Talent"       3000 - 5000 XP     ðŸ¥ˆ          â”‚
â”‚  Level 5    "Gymi-Ready"         5000 - 8000 XP     ðŸ¥‡          â”‚
â”‚  Level 6    "PrÃ¼fungs-Pro"       8000 - 12000 XP    ðŸ¥‡          â”‚
â”‚  Level 7    "Challenge-Master"   12000+ XP          ðŸ’Ž          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 4. User Flows

### Flow A: Unregistrierter Besucher (Viral Entry)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCHRITT 1: EINSTIEG                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Quellen:                                                                â”‚
â”‚  â”œâ”€â”€ ðŸ“° Zeitungsartikel (Embed)                                          â”‚
â”‚  â”œâ”€â”€ ðŸ“± Instagram Story von Freund                                       â”‚
â”‚  â”œâ”€â”€ ðŸ“§ Challenge-Email                                                  â”‚
â”‚  â””â”€â”€ ðŸ”— Direktlink gogymi.ch/challenge                                   â”‚
â”‚                                                                          â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   ðŸ§  Schaffst du die GymiprÃ¼fung?                                  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Diese Aufgabe mussten ZÃ¼rcher SechstklÃ¤ssler                    â”‚  â”‚
â”‚  â”‚   im MÃ¤rz 2024 lÃ¶sen.                                             â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [â–¶ï¸ Challenge starten]                                          â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â±ï¸ Durchschnittliche LÃ¶sungszeit: 52 Sekunden                   â”‚  â”‚
â”‚  â”‚   âœ… Erfolgsquote: 67%                                            â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCHRITT 2: AUFGABE LÃ–SEN                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â±ï¸ 00:34                                         Aufgabe 1/1     â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Ein Zug fÃ¤hrt um 08:15 Uhr in ZÃ¼rich ab und erreicht             â”‚  â”‚
â”‚  â”‚   Bern um 09:11 Uhr. Die Strecke ist 125 km lang.                  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Wie schnell fÃ¤hrt der Zug durchschnittlich in km/h?              â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Deine Antwort:                                                   â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚  â”‚
â”‚  â”‚   â”‚                           km/h  â”‚                              â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [Antwort prÃ¼fen â†’]                                               â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   ðŸ’¡ Tipp: Zeit in Stunden umrechnen!          [Tipp anzeigen]     â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCHRITT 3: ERGEBNIS (FREI - ERSTE AUFGABE)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚                     ðŸŽ‰ Richtig!                                    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚                  Deine Antwort: 134 km/h âœ“                        â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â±ï¸ Deine Zeit              ðŸ“Š Dein Ranking                      â”‚  â”‚
â”‚  â”‚      34 Sekunden                Top 28%                           â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘       Schneller als 72%                 â”‚  â”‚
â”‚  â”‚      Ã˜ 52 Sek.                  der Teilnehmer                    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   +100 XP  Richtige Antwort                                       â”‚  â”‚
â”‚  â”‚   +50 XP   Schneller als Durchschnitt                             â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€                                                         â”‚  â”‚
â”‚  â”‚   150 XP   Total                                                  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [ðŸŽ¯ NÃ¤chste Aufgabe]        [ðŸ“¹ LÃ¶sungsweg ansehen]            â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ODER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   ðŸ¤ Fordere jemanden heraus!                                     â”‚  â”‚
â”‚  â”‚   Kann dein Freund das auch?                                      â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [Email eingeben...] [Challenge senden]                          â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼               â–¼               â–¼
              [NÃ¤chste        [LÃ¶sungsvideo]   [Challenge
               Aufgabe]                          senden]
                    â”‚               â”‚               â”‚
                    â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCHRITT 4A: ZWEITE AUFGABE â†’ REGISTRATION GATE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [Aufgabe wird gelÃ¶st...]                                        â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚                     ðŸ”’ Ergebnis freischalten                      â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      Du hast schon 1 Aufgabe gemeistert! ðŸ’ª                â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      Mit deiner Email:                                     â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      âœ“ Speicherst du deinen Fortschritt                    â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      âœ“ Siehst du dein Ranking                              â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      âœ“ Kannst du Freunde herausfordern                     â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      [Email: ______________________]                       â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â”‚      [Ergebnis anzeigen â†’]                                 â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Bereits dabei? [Einloggen]                                      â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCHRITT 4B: LÃ–SUNGSVIDEO â†’ UPSELLING GATE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   ðŸ“¹ LÃ¶sungsweg: "Textaufgabe Zuggeschwindigkeit"                 â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                   [â–¶ï¸ Blurred Video]                       â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                    ðŸ”’ Video gesperrt                       â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                            â”‚  â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   âœ¨ Dein erstes Video ist GRATIS!                                â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [Email: ______________________]                                 â”‚  â”‚
â”‚  â”‚   [Video freischalten â†’]                                          â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Oder: Alle 200+ LÃ¶sungsvideos mit GoGymi Abo                   â”‚  â”‚
â”‚  â”‚   [Abo entdecken â€“ ab 50 CHF/Monat â†’]                            â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SCHRITT 4C: CHALLENGE SENDEN â†’ EMAIL CAPTURE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   ðŸ¤ Challenge senden                                             â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Du hast diese Aufgabe in 34 Sekunden gelÃ¶st.                   â”‚  â”‚
â”‚  â”‚   Mal sehen, ob dein Freund das auch schafft!                    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Email deines Gegners:                                           â”‚  â”‚
â”‚  â”‚   [______________________________________]                        â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Deine Email (fÃ¼r Benachrichtigung):                             â”‚  â”‚
â”‚  â”‚   [______________________________________]                        â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Optionale Nachricht:                                            â”‚  â”‚
â”‚  â”‚   [______________________________________]                        â”‚  â”‚
â”‚  â”‚   z.B. "Schaffst du das auch? ðŸ˜"                                â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [Challenge senden ðŸš€]                                           â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### Flow B: Challenge-EmpfÃ¤nger

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EMAIL                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [GoGymi Logo]                                                   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   ðŸŽ¯ Du wurdest herausgefordert!                                  â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Lisa hat diese Mathe-Aufgabe aus der GymiprÃ¼fung 2024          â”‚  â”‚
â”‚  â”‚   in 34 Sekunden gelÃ¶st.                                         â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Ihre Nachricht: "Schaffst du das auch? ðŸ˜"                     â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚  â”‚
â”‚  â”‚           â”‚                                 â”‚                     â”‚  â”‚
â”‚  â”‚           â”‚    [Challenge annehmen â†’]       â”‚                     â”‚  â”‚
â”‚  â”‚           â”‚                                 â”‚                     â”‚  â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   GoGymi â€“ Die Lernplattform fÃ¼r die GymiprÃ¼fung                 â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DUELL-SCREEN                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚                        âš”ï¸ DUELL                                   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚        Lisa                              Du                       â”‚  â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”                     â”‚  â”‚
â”‚  â”‚        â”‚ ðŸ‘¤  â”‚          VS            â”‚  ?  â”‚                     â”‚  â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”˜                     â”‚  â”‚
â”‚  â”‚        34 Sek.                        -- Sek.                     â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   Aufgabe: Textaufgabe Zuggeschwindigkeit                        â”‚  â”‚
â”‚  â”‚   Aus: GymiprÃ¼fung 2024                                          â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚                [Challenge annehmen â†’]                             â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                         [Aufgabe lÃ¶sen - wie Flow A]
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DUELL-ERGEBNIS                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚                     ðŸ† DU GEWINNST!                                â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚        Lisa                              Du                        â”‚  â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”                      â”‚  â”‚
â”‚  â”‚        â”‚ ðŸ‘¤  â”‚          VS            â”‚ ðŸ‘¤  â”‚                      â”‚  â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚  â”‚        34 Sek.                        28 Sek. âœ“                    â”‚  â”‚
â”‚  â”‚        âœ“ Richtig                      âœ“ Richtig                    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   +100 XP  Richtige Antwort                                        â”‚  â”‚
â”‚  â”‚   +150 XP  Duell gewonnen                                          â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€                                                          â”‚  â”‚
â”‚  â”‚   250 XP   Total                                                   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [ðŸŽ¯ Neue Challenge]                                              â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚   [ðŸ“¤ Auf Instagram teilen]                                        â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 5. Gamification-Details

### 5.1 Badges/Achievements

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ðŸ… BADGES                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  EINSTEIGER                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   ðŸŽ¯    â”‚ â”‚   âš¡    â”‚ â”‚   ðŸ¤    â”‚ â”‚   ðŸ“š    â”‚ â”‚   ðŸ”¥    â”‚          â”‚
â”‚  â”‚ Erster  â”‚ â”‚ Blitz-  â”‚ â”‚ Social  â”‚ â”‚  Alle   â”‚ â”‚  3er    â”‚          â”‚
â”‚  â”‚ Versuch â”‚ â”‚ lÃ¶ser   â”‚ â”‚ Starter â”‚ â”‚ Themen  â”‚ â”‚ Streak  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  1. Aufgabe  <20 Sek.    1. Einlad.  Je 1 Thema  3 richtig            â”‚
â”‚                                                                         â”‚
â”‚  FORTGESCHRITTEN                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   ðŸ†    â”‚ â”‚   ðŸ’¯    â”‚ â”‚   ðŸ§     â”‚ â”‚   â­    â”‚ â”‚   ðŸŽ–ï¸    â”‚          â”‚
â”‚  â”‚ Duell-  â”‚ â”‚  10er   â”‚ â”‚ Mathe-  â”‚ â”‚  Top    â”‚ â”‚ Wochen- â”‚          â”‚
â”‚  â”‚ Sieger  â”‚ â”‚ Streak  â”‚ â”‚ Meister â”‚ â”‚  10%    â”‚ â”‚ Champ   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  1. Duell    10 richtig  50 Mathe   Zeit-Rank.  #1 Woche             â”‚
â”‚  gewonnen    in Folge    Aufgaben                                      â”‚
â”‚                                                                         â”‚
â”‚  LEGENDÃ„R                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚   ðŸ’Ž    â”‚ â”‚   ðŸ‘‘    â”‚ â”‚   ðŸš€    â”‚                                   â”‚
â”‚  â”‚ Gymi-   â”‚ â”‚ PrÃ¼fungsâ”‚ â”‚ Unauf-  â”‚                                   â”‚
â”‚  â”‚ Ready   â”‚ â”‚ KÃ¶nig   â”‚ â”‚ haltsam â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚  Ganze       5 PrÃ¼fungen 25er Streak                                   â”‚
â”‚  PrÃ¼fung     bestanden                                                  â”‚
â”‚  bestanden                                                              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 5.2 Leaderboard-Struktur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ðŸ† LEADERBOARD                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  [Diese Woche â–¼]    [Mathe â–¼]    [Langzeit â–¼]                          â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚   #   Name              Aufgaben    Ã˜ Zeit      XP                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚   ðŸ¥‡  MaxPower123         47         28s       4'850                   â”‚
â”‚   ðŸ¥ˆ  MatheMaster         43         31s       4'320                   â”‚
â”‚   ðŸ¥‰  LaraZH              38         35s       3'890                   â”‚
â”‚   4   NicoTheGreat        35         29s       3'650                   â”‚
â”‚   5   SchulhausKing       32         42s       3'200                   â”‚
â”‚   ...                                                                   â”‚
â”‚   127 Du                  12         38s       1'150  â† Dein Rang      â”‚
â”‚                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                         â”‚
â”‚  ðŸ“ˆ Noch 8 Aufgaben bis Rang 100!                                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 5.3 Daily Challenge

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â­ TÃ„GLICHE CHALLENGE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Aufgabe des Tages: "Die knifflige Textaufgabe"                        â”‚
â”‚                                                                         â”‚
â”‚  ðŸŽ BONUS: 2x XP fÃ¼r alle, die heute lÃ¶sen!                            â”‚
â”‚                                                                         â”‚
â”‚  â° Endet in: 14:32:05                                                  â”‚
â”‚                                                                         â”‚
â”‚  Heute schon gelÃ¶st: 1'247 Teilnehmer                                  â”‚
â”‚  Erfolgsquote: 43%                                                      â”‚
â”‚                                                                         â”‚
â”‚  [Jetzt Challenge starten â†’]                                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 6. UI Components (shadcn/ui)

### 6.1 Komponenten-Ãœbersicht

```
CORE COMPONENTS:
â”œâ”€â”€ TaskCard           # Aufgaben-Anzeige
â”œâ”€â”€ Timer              # Countdown wÃ¤hrend LÃ¶sen
â”œâ”€â”€ AnswerInput        # Eingabefeld (Number, Text, MultipleChoice)
â”œâ”€â”€ ResultScreen       # Ergebnis mit Animation
â”œâ”€â”€ ProgressBar        # Zeit-Vergleich
â”œâ”€â”€ RankingBadge       # "Top 28%"
â”œâ”€â”€ XPCounter          # Animierte Punkte
â”œâ”€â”€ RegistrationGate   # Email-Capture Modal
â”œâ”€â”€ ChallengeInvite    # Einladungsformular
â”œâ”€â”€ Leaderboard        # Rangliste
â”œâ”€â”€ BadgeDisplay       # Achievement-Anzeige
â”œâ”€â”€ DuelCard           # VS-Anzeige fÃ¼r Duelle
â””â”€â”€ ShareButtons       # Social Sharing

LAYOUT COMPONENTS:
â”œâ”€â”€ ChallengeLayout    # Wrapper fÃ¼r Challenge-Seiten
â”œâ”€â”€ EmbedLayout        # Minimalistisch fÃ¼r iframes
â””â”€â”€ DashboardLayout    # FÃ¼r registrierte User

```

### 6.2 Design Tokens

```css
/* colors.css - GoGymi Brand angepasst */
:root {
  /* Primary - GoGymi Blau */
  --primary: 220 90% 56%;
  --primary-foreground: 0 0% 100%;

  /* Accent - Energetisches Orange */
  --accent: 25 95% 53%;
  --accent-foreground: 0 0% 100%;

  /* Success - GrÃ¼n fÃ¼r richtige Antworten */
  --success: 142 76% 36%;
  --success-foreground: 0 0% 100%;

  /* Error - Rot fÃ¼r falsche Antworten */
  --destructive: 0 84% 60%;
  --destructive-foreground: 0 0% 100%;

  /* Neutral */
  --background: 0 0% 100%;
  --foreground: 222 47% 11%;
  --muted: 210 40% 96%;
  --muted-foreground: 215 16% 47%;

  /* Card */
  --card: 0 0% 100%;
  --card-foreground: 222 47% 11%;
  --border: 214 32% 91%;

  /* Radius - Friendly, rounded */
  --radius: 0.75rem;
}

/* Dark Mode */
.dark {
  --background: 222 47% 11%;
  --foreground: 210 40% 98%;
  --card: 222 47% 15%;
  --muted: 217 33% 17%;
}

```

### 6.3 Typography

```css
/* Passend zum GoGymi Tone of Voice */
:root {
  --font-heading: 'Plus Jakarta Sans', sans-serif;  /* Modern, friendly */
  --font-body: 'Inter', sans-serif;                 /* Clean, readable */
  --font-mono: 'JetBrains Mono', monospace;         /* FÃ¼r Zahlen/Code */
}

/* Headings - Bold & Playful */
h1 { @apply text-3xl md:text-4xl font-bold tracking-tight; }
h2 { @apply text-2xl md:text-3xl font-semibold; }
h3 { @apply text-xl md:text-2xl font-semibold; }

/* Body - Clear & Readable */
.body-large { @apply text-lg leading-relaxed; }
.body { @apply text-base leading-relaxed; }
.body-small { @apply text-sm leading-relaxed; }

/* Numbers - Tabular for alignment */
.number { @apply font-mono tabular-nums; }

```

---

## 7. Micro-Interactions & Feedback

### 7.1 Animationen

```
TIMER START:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â±ï¸ 3... 2... 1... LOS!                â”‚
â”‚     [Countdown Animation]               â”‚
â”‚     [Pulsierender Timer startet]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RICHTIGE ANTWORT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ [GrÃ¼ner Checkmark fliegt rein]      â”‚
â”‚  ðŸŽ‰ [Confetti Animation]                â”‚
â”‚  +150 XP [Zahlen zÃ¤hlen hoch]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FALSCHE ANTWORT:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ— [Roter X mit Shake]                  â”‚
â”‚  [Karte wackelt leicht]                 â”‚
â”‚  "Fast! Die richtige Antwort war..."   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STREAK:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ”¥ 3er Streak!                         â”‚
â”‚  [Flammen-Animation am Rand]            â”‚
â”‚  [Streak-Counter pulsiert]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LEVEL UP:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â¬†ï¸ LEVEL UP!                          â”‚
â”‚  [Goldener Rahmen leuchtet auf]         â”‚
â”‚  "Du bist jetzt: Mathe-Talent"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 7.2 Sound Design (Optional)

```
EVENT              SOUND
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Timer Start        Soft "ding"
Answer Submit      Click
Correct Answer     Cheerful chime
Wrong Answer       Soft "womp"
Streak             Fire crackle
Level Up           Triumphant fanfare
Duell Won          Victory tune
Badge Earned       Achievement unlock

```

---

## 8. Embed-Varianten fÃ¼r Medien

### 8.1 Standard Embed (500px)

```html
<iframe
  src="https://gogymi.ch/embed/challenge?task=zap2024-m-12"
  width="100%"
  height="500"
  style="border: none; border-radius: 12px;"
></iframe>

```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚   [GoGymi Logo]                        GymiprÃ¼fung 2024 | Mathematik   â”‚
â”‚                                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                                                                         â”‚
â”‚   Ein Zug fÃ¤hrt um 08:15 Uhr in ZÃ¼rich ab...                          â”‚
â”‚                                                                         â”‚
â”‚   Deine Antwort: [____________] km/h                                   â”‚
â”‚                                                                         â”‚
â”‚   [Antwort prÃ¼fen â†’]                                                   â”‚
â”‚                                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   â±ï¸ Ã˜ 52 Sek. | âœ… 67% Erfolgsquote | 1'247 haben's versucht         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 8.2 Compact Embed (300px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ§  Schaffst du diese Gymi-Aufgabe?    â”‚
â”‚                                         â”‚
â”‚  [â–¶ï¸ Jetzt testen]                     â”‚
â”‚                                         â”‚
â”‚  Nur 43% schaffen das!                 â”‚
â”‚                           [GoGymi]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 8.3 Medien-spezifische Varianten

```
URL-PARAMETER:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
?preset=easy       â†’ Einfache Aufgabe (breitere Masse)
?preset=hard       â†’ Schwere Aufgabe ("Nur 12% schaffen das")
?preset=viral      â†’ Die "gemeinste" Aufgabe des Jahres
?theme=dark        â†’ Dunkles Theme
?theme=tagi        â†’ Tagesanzeiger-Branding
?theme=nzz         â†’ NZZ-Branding
?compact=true      â†’ Minimale HÃ¶he
?utm_source=tagi   â†’ Tracking

```

---

## 9. Mobile-First Screens

```
MOBILE (375px)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â†  Challenge      â±ï¸ 00:34 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  Aufgabe 1/1                â”‚
â”‚                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                             â”‚
â”‚  Ein Zug fÃ¤hrt um 08:15     â”‚
â”‚  Uhr in ZÃ¼rich ab und       â”‚
â”‚  erreicht Bern um 09:11     â”‚
â”‚  Uhr. Die Strecke ist       â”‚
â”‚  125 km lang.               â”‚
â”‚                             â”‚
â”‚  Wie schnell fÃ¤hrt der      â”‚
â”‚  Zug durchschnittlich?      â”‚
â”‚                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  km/h â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Antwort prÃ¼fen â†’    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚
â”‚  ðŸ’¡ Tipp anzeigen           â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

# Technische Planung

---

## 1. Systemarchitektur

### 1.1 High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   CLIENTS                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚   Web App    â”‚    â”‚  Embed       â”‚    â”‚  WordPress   â”‚    â”‚   Mobile     â”‚ â”‚
â”‚   â”‚  (Next.js)   â”‚    â”‚  (iframe)    â”‚    â”‚  (Shortcode) â”‚    â”‚   (PWA)      â”‚ â”‚
â”‚   â”‚              â”‚    â”‚              â”‚    â”‚              â”‚    â”‚              â”‚ â”‚
â”‚   â”‚ gogymi.ch/   â”‚    â”‚ /embed/      â”‚    â”‚ gogymi.ch/   â”‚    â”‚ App Clip     â”‚ â”‚
â”‚   â”‚ challenge    â”‚    â”‚ challenge    â”‚    â”‚ kurse        â”‚    â”‚ (spÃ¤ter)     â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚                   â”‚                   â”‚                   â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                   â”‚                   â”‚                   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   VERCEL                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         NEXT.JS 14 (App Router)                         â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚   â”‚   â”‚  Server         â”‚   â”‚  API Routes     â”‚   â”‚  Edge           â”‚      â”‚   â”‚
â”‚   â”‚   â”‚  Components     â”‚   â”‚  /api/*         â”‚   â”‚  Middleware     â”‚      â”‚   â”‚
â”‚   â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚                 â”‚      â”‚   â”‚
â”‚   â”‚   â”‚  - Pages        â”‚   â”‚  - /challenge   â”‚   â”‚  - Auth Check   â”‚      â”‚   â”‚
â”‚   â”‚   â”‚  - Layouts      â”‚   â”‚  - /invite      â”‚   â”‚  - Rate Limit   â”‚      â”‚   â”‚
â”‚   â”‚   â”‚  - Data Fetch   â”‚   â”‚  - /webhooks    â”‚   â”‚  - Geo Routing  â”‚      â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                           VERCEL EDGE CONFIG                              â”‚ â”‚
â”‚   â”‚                     (Feature Flags, A/B Tests)                            â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                               â”‚                               â”‚
           â–¼                               â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SUPABASE       â”‚     â”‚    EXTERNE APIs     â”‚     â”‚      STORAGE        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     â”‚     â”‚                     â”‚     â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PostgreSQL   â”‚  â”‚     â”‚  â”‚    Resend     â”‚  â”‚     â”‚  â”‚ Supabase      â”‚  â”‚
â”‚  â”‚               â”‚  â”‚     â”‚  â”‚   (Email)     â”‚  â”‚     â”‚  â”‚ Storage       â”‚  â”‚
â”‚  â”‚  - profiles   â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â”‚               â”‚  â”‚
â”‚  â”‚  - tasks      â”‚  â”‚     â”‚                     â”‚     â”‚  â”‚ - Videos      â”‚  â”‚
â”‚  â”‚  - sessions   â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”‚ - Images      â”‚  â”‚
â”‚  â”‚  - invites    â”‚  â”‚     â”‚  â”‚    Stripe     â”‚  â”‚     â”‚  â”‚ - Assets      â”‚  â”‚
â”‚  â”‚  - subs       â”‚  â”‚     â”‚  â”‚  (Payments)   â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚                     â”‚
â”‚                     â”‚     â”‚                     â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚  â”‚ Vercel Blob   â”‚  â”‚
â”‚  â”‚  Supabase     â”‚  â”‚     â”‚  â”‚   PostHog     â”‚  â”‚     â”‚  â”‚ (User Upload) â”‚  â”‚
â”‚  â”‚  Auth         â”‚  â”‚     â”‚  â”‚  (Analytics)  â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚               â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚                     â”‚
â”‚  â”‚  - Email/PW   â”‚  â”‚     â”‚                     â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚  - Magic Link â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  - OAuth      â”‚  â”‚     â”‚  â”‚   OpenAI      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â”‚  (KI-Tutor)   â”‚  â”‚
â”‚                     â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚                     â”‚
â”‚  â”‚  Realtime     â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚  (WebSockets) â”‚  â”‚
â”‚  â”‚               â”‚  â”‚
â”‚  â”‚  - Duell-Sync â”‚  â”‚
â”‚  â”‚  - Leaderboardâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 1.2 Datenfluss

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CHALLENGE FLOW - DATENFLUSS                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. AUFGABE LADEN
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client â”‚ â”€â”€GETâ”€â”€â–¶â”‚ Next.jsâ”‚ â”€â”€SQLâ”€â”€â–¶â”‚Supabaseâ”‚
   â”‚        â”‚â—€â”€â”€JSONâ”€â”€â”‚ Server â”‚â—€â”€â”€Rowâ”€â”€â”€â”‚   DB   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. ANTWORT EINREICHEN
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client â”‚ â”€â”€POSTâ”€â–¶â”‚  API   â”‚ â”€â”€SQLâ”€â”€â–¶â”‚Supabaseâ”‚         â”‚PostHog â”‚
   â”‚        â”‚         â”‚ Route  â”‚         â”‚   DB   â”‚         â”‚        â”‚
   â”‚        â”‚â—€â”€â”€JSONâ”€â”€â”‚        â”‚â”€â”€Eventâ”€â–¶â”‚        â”‚â”€â”€Trackâ”€â–¶â”‚        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. CHALLENGE SENDEN
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client â”‚ â”€â”€POSTâ”€â–¶â”‚  API   â”‚ â”€â”€SQLâ”€â”€â–¶â”‚Supabaseâ”‚         â”‚ Resend â”‚
   â”‚        â”‚         â”‚ Route  â”‚         â”‚   DB   â”‚         â”‚        â”‚
   â”‚        â”‚â—€â”€â”€JSONâ”€â”€â”‚        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚        â”‚â”€â”€Emailâ”€â–¶â”‚        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. REALTIME LEADERBOARD
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Client â”‚â—€â”€â”€WSâ”€â”€â”€â”€â”‚Supabaseâ”‚â—€â”€â”€DBâ”€â”€â”€â”€â”‚  New   â”‚
   â”‚        â”‚         â”‚Realtimeâ”‚  Change â”‚ Score  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 2. Datenbank-Schema (PostgreSQL)

### 2.1 Entity Relationship Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DATABASE SCHEMA                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚    auth.users     â”‚
                            â”‚   (Supabase)      â”‚
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â”‚ id: uuid [PK]     â”‚
                            â”‚ email: text       â”‚
                            â”‚ created_at: ts    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ 1:1
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     schools       â”‚         â”‚     profiles      â”‚         â”‚   subscriptions   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid [PK]     â”‚â—€â”€â”€1:Nâ”€â”€â”€â”‚ id: uuid [PK][FK] â”‚â”€â”€â”€1:Nâ”€â”€â–¶â”‚ id: uuid [PK]     â”‚
â”‚ name: text        â”‚         â”‚ email: text       â”‚         â”‚ user_id: uuid [FK]â”‚
â”‚ type: enum        â”‚         â”‚ display_name: textâ”‚         â”‚ tier: enum        â”‚
â”‚ canton: text      â”‚         â”‚ school_id: uuid   â”‚         â”‚ stripe_id: text   â”‚
â”‚ created_at: ts    â”‚         â”‚ role: enum        â”‚         â”‚ starts_at: ts     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ avatar_url: text  â”‚         â”‚ ends_at: ts       â”‚
                              â”‚ xp_total: int     â”‚         â”‚ status: enum      â”‚
                              â”‚ level: int        â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ streak_current: intâ”‚
                              â”‚ streak_best: int  â”‚
                              â”‚ created_at: ts    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                   â”‚                   â”‚
                    â–¼                   â–¼                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  user_badges      â”‚ â”‚challenge_sessions â”‚ â”‚ challenge_invites â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ id: uuid [PK]     â”‚ â”‚ id: uuid [PK]     â”‚ â”‚ id: uuid [PK]     â”‚
        â”‚ user_id: uuid [FK]â”‚ â”‚ visitor_id: text  â”‚ â”‚ task_id: text [FK]â”‚
        â”‚ badge_id: text    â”‚ â”‚ user_id: uuid [FK]â”‚ â”‚ challenger_email  â”‚
        â”‚ earned_at: ts     â”‚ â”‚ task_id: text [FK]â”‚ â”‚ challenger_sessionâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ answer: jsonb     â”‚ â”‚ opponent_email    â”‚
                              â”‚ is_correct: bool  â”‚ â”‚ opponent_session  â”‚
                              â”‚ time_seconds: int â”‚ â”‚ invite_token: textâ”‚
                              â”‚ xp_earned: int    â”‚ â”‚ status: enum      â”‚
                              â”‚ source: text      â”‚ â”‚ message: text     â”‚
                              â”‚ utm_source: text  â”‚ â”‚ created_at: ts    â”‚
                              â”‚ created_at: ts    â”‚ â”‚ accepted_at: ts   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ completed_at: ts  â”‚
                                        â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚      tasks        â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                              â”‚ id: text [PK]     â”‚
                              â”‚ exam_year: int    â”‚
                              â”‚ exam_type: enum   â”‚
                              â”‚ subject: enum     â”‚
                              â”‚ topic: text       â”‚
                              â”‚ subtopic: text    â”‚
                              â”‚ difficulty: int   â”‚
                              â”‚ question_html: textâ”‚
                              â”‚ question_image: textâ”‚
                              â”‚ answer_type: enum â”‚
                              â”‚ correct_answer: jsonbâ”‚
                              â”‚ solution_video_urlâ”‚
                              â”‚ solution_text: textâ”‚
                              â”‚ hints: jsonb      â”‚
                              â”‚ avg_time_seconds  â”‚
                              â”‚ success_rate: floatâ”‚
                              â”‚ attempt_count: intâ”‚
                              â”‚ created_at: ts    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### 2.2 SQL Schema Definition

```sql
-- ============================================================================
-- ENUMS
-- ============================================================================

CREATE TYPE user_role AS ENUM ('student', 'teacher', 'parent', 'admin');
CREATE TYPE subscription_tier AS ENUM ('free', 'monthly', 'half_yearly', 'yearly');
CREATE TYPE subscription_status AS ENUM ('active', 'cancelled', 'expired', 'trial');
CREATE TYPE exam_type AS ENUM ('zap1', 'zap2', 'zap3');
CREATE TYPE subject AS ENUM ('math', 'german_grammar', 'german_essay');
CREATE TYPE answer_type AS ENUM ('number', 'text', 'multiple_choice', 'multiple_select');
CREATE TYPE invite_status AS ENUM ('pending', 'accepted', 'completed', 'expired');
CREATE TYPE school_type AS ENUM ('primary', 'secondary', 'gymnasium', 'private');

-- ============================================================================
-- TABLES
-- ============================================================================

-- Schools (fÃ¼r spÃ¤tere Klassen-Challenges)
CREATE TABLE schools (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL,
    type school_type NOT NULL,
    canton TEXT DEFAULT 'ZH',
    city TEXT,
    is_partner BOOLEAN DEFAULT false,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- User Profiles (erweitert Supabase Auth)
CREATE TABLE profiles (
    id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
    email TEXT UNIQUE NOT NULL,
    display_name TEXT,
    avatar_url TEXT,
    school_id UUID REFERENCES schools(id),
    role user_role DEFAULT 'student',

    -- Gamification
    xp_total INTEGER DEFAULT 0,
    level INTEGER DEFAULT 1,
    streak_current INTEGER DEFAULT 0,
    streak_best INTEGER DEFAULT 0,
    last_activity_date DATE,

    -- Preferences
    preferred_exam_type exam_type,
    notification_email BOOLEAN DEFAULT true,
    notification_challenge BOOLEAN DEFAULT true,

    -- Metadata
    utm_source TEXT,
    utm_medium TEXT,
    utm_campaign TEXT,
    referrer_id UUID REFERENCES profiles(id),

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Subscriptions
CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES profiles(id) ON DELETE CASCADE,
    tier subscription_tier NOT NULL DEFAULT 'free',
    status subscription_status NOT NULL DEFAULT 'active',

    -- Stripe
    stripe_customer_id TEXT,
    stripe_subscription_id TEXT,
    stripe_price_id TEXT,

    -- Dates
    starts_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    ends_at TIMESTAMPTZ,
    cancelled_at TIMESTAMPTZ,
    trial_ends_at TIMESTAMPTZ,

    -- Usage Tracking (fÃ¼r Free Tier Limits)
    free_results_used INTEGER DEFAULT 0,
    free_videos_used INTEGER DEFAULT 0,
    free_exams_used INTEGER DEFAULT 0,

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(user_id, status) -- Nur ein aktives Abo pro User
);

-- Tasks (Aufgaben aus PrÃ¼fungsarchiv)
CREATE TABLE tasks (
    id TEXT PRIMARY KEY, -- z.B. 'zap1-2024-math-12'

    -- Classification
    exam_year INTEGER NOT NULL,
    exam_type exam_type NOT NULL,
    subject subject NOT NULL,
    topic TEXT NOT NULL,
    subtopic TEXT,
    difficulty INTEGER CHECK (difficulty BETWEEN 1 AND 5),
    task_number INTEGER, -- Aufgabennummer in Original-PrÃ¼fung

    -- Content
    question_html TEXT NOT NULL,
    question_image_url TEXT,
    answer_type answer_type NOT NULL,
    correct_answer JSONB NOT NULL,
    /*
        Beispiele fÃ¼r correct_answer:
        - Number: {"value": 134, "tolerance": 0.5, "unit": "km/h"}
        - Text: {"value": "Beispielantwort", "keywords": ["keyword1", "keyword2"]}
        - Multiple Choice: {"correct_index": 2, "options": ["A", "B", "C", "D"]}
        - Multiple Select: {"correct_indices": [0, 2], "options": ["A", "B", "C", "D"]}
    */

    -- Solution
    solution_text TEXT,
    solution_video_url TEXT,
    solution_steps JSONB, -- Schrittweise LÃ¶sung fÃ¼r KI-Tutor
    hints JSONB DEFAULT '[]', -- Array von Tipps

    -- Statistics (werden regelmÃ¤ssig aktualisiert)
    avg_time_seconds INTEGER,
    success_rate FLOAT,
    attempt_count INTEGER DEFAULT 0,

    -- Flags
    is_active BOOLEAN DEFAULT true,
    is_featured BOOLEAN DEFAULT false, -- FÃ¼r Daily Challenge
    is_embed_allowed BOOLEAN DEFAULT true, -- FÃ¼r Medien-Embeds

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Challenge Sessions
CREATE TABLE challenge_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- User (einer von beiden)
    visitor_id TEXT, -- Cookie-basiert fÃ¼r GÃ¤ste
    user_id UUID REFERENCES profiles(id),

    -- Task
    task_id TEXT NOT NULL REFERENCES tasks(id),

    -- Answer
    answer JSONB NOT NULL,
    is_correct BOOLEAN NOT NULL,
    time_seconds INTEGER NOT NULL,
    hints_used INTEGER DEFAULT 0,

    -- Gamification
    xp_earned INTEGER DEFAULT 0,
    streak_at_time INTEGER DEFAULT 0,

    -- Context
    source TEXT DEFAULT 'web', -- 'web', 'embed', 'app', 'wordpress'
    utm_source TEXT,
    utm_medium TEXT,
    utm_campaign TEXT,
    embed_host TEXT, -- z.B. 'tagesanzeiger.ch'

    -- Duell Reference
    invite_id UUID REFERENCES challenge_invites(id),

    created_at TIMESTAMPTZ DEFAULT NOW(),

    -- Index fÃ¼r Leaderboard-Queries
    CONSTRAINT valid_user CHECK (visitor_id IS NOT NULL OR user_id IS NOT NULL)
);

-- Challenge Invites (Duelle)
CREATE TABLE challenge_invites (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Task
    task_id TEXT NOT NULL REFERENCES tasks(id),

    -- Challenger
    challenger_email TEXT NOT NULL,
    challenger_user_id UUID REFERENCES profiles(id),
    challenger_session_id UUID REFERENCES challenge_sessions(id),
    challenger_time_seconds INTEGER,

    -- Opponent
    opponent_email TEXT NOT NULL,
    opponent_user_id UUID REFERENCES profiles(id),
    opponent_session_id UUID REFERENCES challenge_sessions(id),
    opponent_time_seconds INTEGER,

    -- Invite
    invite_token TEXT UNIQUE DEFAULT encode(gen_random_bytes(16), 'hex'),
    custom_message TEXT,

    -- Status
    status invite_status DEFAULT 'pending',
    winner_email TEXT,

    -- Timestamps
    created_at TIMESTAMPTZ DEFAULT NOW(),
    sent_at TIMESTAMPTZ,
    accepted_at TIMESTAMPTZ,
    completed_at TIMESTAMPTZ,
    expires_at TIMESTAMPTZ DEFAULT NOW() + INTERVAL '7 days'
);

-- Badges
CREATE TABLE badges (
    id TEXT PRIMARY KEY, -- z.B. 'first_challenge', 'streak_10'
    name TEXT NOT NULL,
    description TEXT NOT NULL,
    icon TEXT NOT NULL, -- Emoji oder Icon-Name
    category TEXT NOT NULL, -- 'beginner', 'advanced', 'legendary'
    xp_reward INTEGER DEFAULT 0,
    condition_type TEXT NOT NULL, -- 'task_count', 'streak', 'speed', etc.
    condition_value JSONB NOT NULL,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- User Badges (N:M Relation)
CREATE TABLE user_badges (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES profiles(id) ON DELETE CASCADE,
    badge_id TEXT NOT NULL REFERENCES badges(id),
    earned_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(user_id, badge_id)
);

-- Daily Challenges
CREATE TABLE daily_challenges (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    task_id TEXT NOT NULL REFERENCES tasks(id),
    challenge_date DATE NOT NULL UNIQUE,
    xp_multiplier FLOAT DEFAULT 2.0,
    participant_count INTEGER DEFAULT 0,
    avg_time_seconds INTEGER,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Guest Sessions (fÃ¼r unregistrierte Nutzer)
CREATE TABLE guest_sessions (
    visitor_id TEXT PRIMARY KEY,

    -- Limits
    free_results_used INTEGER DEFAULT 0,
    free_videos_used INTEGER DEFAULT 0,
    free_exams_used INTEGER DEFAULT 0,

    -- Conversion
    email_captured TEXT,
    converted_to_user_id UUID REFERENCES profiles(id),
    converted_at TIMESTAMPTZ,

    -- Metadata
    first_seen_at TIMESTAMPTZ DEFAULT NOW(),
    last_seen_at TIMESTAMPTZ DEFAULT NOW(),
    utm_source TEXT,

    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- ============================================================================
-- INDEXES
-- ============================================================================

-- Performance Indexes
CREATE INDEX idx_sessions_task_time ON challenge_sessions(task_id, time_seconds)
    WHERE is_correct = true;
CREATE INDEX idx_sessions_user ON challenge_sessions(user_id) WHERE user_id IS NOT NULL;
CREATE INDEX idx_sessions_visitor ON challenge_sessions(visitor_id) WHERE visitor_id IS NOT NULL;
CREATE INDEX idx_sessions_created ON challenge_sessions(created_at DESC);
CREATE INDEX idx_sessions_source ON challenge_sessions(source, utm_source);

CREATE INDEX idx_invites_token ON challenge_invites(invite_token);
CREATE INDEX idx_invites_opponent ON challenge_invites(opponent_email, status);
CREATE INDEX idx_invites_challenger ON challenge_invites(challenger_email);

CREATE INDEX idx_tasks_exam ON tasks(exam_type, exam_year, subject);
CREATE INDEX idx_tasks_topic ON tasks(topic, subtopic);
CREATE INDEX idx_tasks_difficulty ON tasks(difficulty);
CREATE INDEX idx_tasks_featured ON tasks(is_featured) WHERE is_featured = true;

CREATE INDEX idx_profiles_xp ON profiles(xp_total DESC);
CREATE INDEX idx_profiles_school ON profiles(school_id);

CREATE INDEX idx_user_badges_user ON user_badges(user_id);

-- ============================================================================
-- VIEWS
-- ============================================================================

-- Leaderboard View (WÃ¶chentlich)
CREATE OR REPLACE VIEW leaderboard_weekly AS
SELECT
    COALESCE(cs.user_id::text, cs.visitor_id) as player_id,
    p.display_name,
    p.avatar_url,
    COUNT(*) FILTER (WHERE cs.is_correct) as correct_count,
    COUNT(*) as total_attempts,
    ROUND(AVG(cs.time_seconds) FILTER (WHERE cs.is_correct)) as avg_time,
    MIN(cs.time_seconds) FILTER (WHERE cs.is_correct) as best_time,
    SUM(cs.xp_earned) as weekly_xp
FROM challenge_sessions cs
LEFT JOIN profiles p ON cs.user_id = p.id
WHERE cs.created_at > NOW() - INTERVAL '7 days'
GROUP BY COALESCE(cs.user_id::text, cs.visitor_id), p.display_name, p.avatar_url
ORDER BY weekly_xp DESC, correct_count DESC;

-- Task Statistics View
CREATE OR REPLACE VIEW task_statistics AS
SELECT
    t.id,
    t.topic,
    t.difficulty,
    COUNT(cs.id) as attempt_count,
    ROUND(AVG(cs.time_seconds)) as avg_time,
    ROUND(100.0 * COUNT(*) FILTER (WHERE cs.is_correct) / NULLIF(COUNT(*), 0), 1) as success_rate
FROM tasks t
LEFT JOIN challenge_sessions cs ON t.id = cs.task_id
GROUP BY t.id;

-- ============================================================================
-- FUNCTIONS
-- ============================================================================

-- Calculate XP for a session
CREATE OR REPLACE FUNCTION calculate_xp(
    p_is_correct BOOLEAN,
    p_time_seconds INTEGER,
    p_avg_time INTEGER,
    p_streak INTEGER,
    p_is_daily BOOLEAN DEFAULT false
) RETURNS INTEGER AS $$
DECLARE
    base_xp INTEGER := 0;
    time_bonus INTEGER := 0;
    streak_bonus INTEGER := 0;
    daily_multiplier FLOAT := 1.0;
BEGIN
    -- Base XP for correct answer
    IF p_is_correct THEN
        base_xp := 100;

        -- Time bonus
        IF p_time_seconds < p_avg_time THEN
            time_bonus := 50;
        END IF;
        IF p_time_seconds < p_avg_time * 0.5 THEN
            time_bonus := 100; -- Top 10% speed
        END IF;

        -- Streak bonus
        IF p_streak >= 3 THEN streak_bonus := 50; END IF;
        IF p_streak >= 5 THEN streak_bonus := 100; END IF;
        IF p_streak >= 10 THEN streak_bonus := 200; END IF;
    END IF;

    -- Daily challenge multiplier
    IF p_is_daily THEN
        daily_multiplier := 2.0;
    END IF;

    RETURN FLOOR((base_xp + time_bonus + streak_bonus) * daily_multiplier);
END;
$$ LANGUAGE plpgsql;

-- Update user stats after challenge
CREATE OR REPLACE FUNCTION update_user_stats()
RETURNS TRIGGER AS $$
BEGIN
    IF NEW.user_id IS NOT NULL AND NEW.is_correct THEN
        UPDATE profiles
        SET
            xp_total = xp_total + NEW.xp_earned,
            streak_current = CASE
                WHEN last_activity_date = CURRENT_DATE - 1 OR last_activity_date = CURRENT_DATE
                THEN streak_current + 1
                ELSE 1
            END,
            streak_best = GREATEST(streak_best, streak_current + 1),
            last_activity_date = CURRENT_DATE,
            level = CASE
                WHEN xp_total + NEW.xp_earned >= 12000 THEN 7
                WHEN xp_total + NEW.xp_earned >= 8000 THEN 6
                WHEN xp_total + NEW.xp_earned >= 5000 THEN 5
                WHEN xp_total + NEW.xp_earned >= 3000 THEN 4
                WHEN xp_total + NEW.xp_earned >= 1500 THEN 3
                WHEN xp_total + NEW.xp_earned >= 500 THEN 2
                ELSE 1
            END,
            updated_at = NOW()
        WHERE id = NEW.user_id;
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_update_user_stats
    AFTER INSERT ON challenge_sessions
    FOR EACH ROW
    EXECUTE FUNCTION update_user_stats();

-- Update task statistics
CREATE OR REPLACE FUNCTION update_task_stats()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE tasks
    SET
        attempt_count = attempt_count + 1,
        avg_time_seconds = (
            SELECT ROUND(AVG(time_seconds))
            FROM challenge_sessions
            WHERE task_id = NEW.task_id AND is_correct = true
        ),
        success_rate = (
            SELECT ROUND(100.0 * COUNT(*) FILTER (WHERE is_correct) / COUNT(*), 1)
            FROM challenge_sessions
            WHERE task_id = NEW.task_id
        ),
        updated_at = NOW()
    WHERE id = NEW.task_id;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_update_task_stats
    AFTER INSERT ON challenge_sessions
    FOR EACH ROW
    EXECUTE FUNCTION update_task_stats();

-- ============================================================================
-- ROW LEVEL SECURITY
-- ============================================================================

ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE subscriptions ENABLE ROW LEVEL SECURITY;
ALTER TABLE challenge_sessions ENABLE ROW LEVEL SECURITY;
ALTER TABLE challenge_invites ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_badges ENABLE ROW LEVEL SECURITY;

-- Profiles: Users can read all, update own
CREATE POLICY "Public profiles are viewable by everyone"
    ON profiles FOR SELECT
    USING (true);

CREATE POLICY "Users can update own profile"
    ON profiles FOR UPDATE
    USING (auth.uid() = id);

-- Subscriptions: Users can only see own
CREATE POLICY "Users can view own subscriptions"
    ON subscriptions FOR SELECT
    USING (auth.uid() = user_id);

-- Challenge Sessions: Users can see own, aggregates are public
CREATE POLICY "Users can view own sessions"
    ON challenge_sessions FOR SELECT
    USING (auth.uid() = user_id OR user_id IS NULL);

CREATE POLICY "Anyone can insert sessions"
    ON challenge_sessions FOR INSERT
    WITH CHECK (true);

-- Invites: Participants can see
CREATE POLICY "Invite participants can view"
    ON challenge_invites FOR SELECT
    USING (
        challenger_email = auth.jwt()->>'email' OR
        opponent_email = auth.jwt()->>'email'
    );

-- Badges: Public read
CREATE POLICY "Badges are public"
    ON user_badges FOR SELECT
    USING (true);
```

---

## 3. API Design

### 3.1 API Endpoints Ãœbersicht

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              API ENDPOINTS                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

BASE URL: /api

TASKS
â”œâ”€â”€ GET    /tasks                      # Liste aller Aufgaben (gefiltert)
â”œâ”€â”€ GET    /tasks/:id                  # Einzelne Aufgabe
â”œâ”€â”€ GET    /tasks/random               # ZufÃ¤llige Aufgabe
â””â”€â”€ GET    /tasks/daily                # TÃ¤gliche Challenge

CHALLENGES
â”œâ”€â”€ POST   /challenges/start           # Challenge starten (Task ID zurÃ¼ck)
â”œâ”€â”€ POST   /challenges/submit          # Antwort einreichen
â”œâ”€â”€ GET    /challenges/history         # Eigene Historie
â””â”€â”€ GET    /challenges/stats           # Eigene Statistiken

INVITES
â”œâ”€â”€ POST   /invites                    # Challenge senden
â”œâ”€â”€ GET    /invites/:token             # Invite Details abrufen
â”œâ”€â”€ POST   /invites/:token/accept      # Challenge annehmen
â””â”€â”€ GET    /invites/pending            # Offene Challenges

LEADERBOARD
â”œâ”€â”€ GET    /leaderboard                # Global Leaderboard
â”œâ”€â”€ GET    /leaderboard/weekly         # WÃ¶chentliches Ranking
â””â”€â”€ GET    /leaderboard/task/:id       # Task-spezifisches Ranking

USER
â”œâ”€â”€ GET    /user/profile               # Eigenes Profil
â”œâ”€â”€ PATCH  /user/profile               # Profil aktualisieren
â”œâ”€â”€ GET    /user/badges                # Eigene Badges
â””â”€â”€ GET    /user/subscription          # Abo-Status

AUTH
â”œâ”€â”€ POST   /auth/register              # Registrierung (Email Capture)
â”œâ”€â”€ POST   /auth/magic-link            # Magic Link senden
â””â”€â”€ POST   /auth/convert-guest         # Guest zu User konvertieren

WEBHOOKS
â”œâ”€â”€ POST   /webhooks/stripe            # Stripe Events
â””â”€â”€ POST   /webhooks/resend            # Email Events

EMBED
â””â”€â”€ GET    /embed/task/:id             # Task fÃ¼r iframe (CORS enabled)

```

### 3.2 API Types (TypeScript)

```tsx
// types/api.ts

// ============================================================================
// REQUEST TYPES
// ============================================================================

export interface GetTasksRequest {
  exam_type?: 'zap1' | 'zap2' | 'zap3';
  subject?: 'math' | 'german_grammar' | 'german_essay';
  topic?: string;
  difficulty?: 1 | 2 | 3 | 4 | 5;
  limit?: number;
  offset?: number;
}

export interface SubmitChallengeRequest {
  task_id: string;
  answer: AnswerValue;
  time_seconds: number;
  hints_used?: number;
  visitor_id?: string; // FÃ¼r GÃ¤ste
  source?: 'web' | 'embed' | 'app' | 'wordpress';
  utm_source?: string;
  utm_medium?: string;
  utm_campaign?: string;
  embed_host?: string;
}

export interface CreateInviteRequest {
  task_id: string;
  session_id: string;
  challenger_email: string;
  opponent_email: string;
  custom_message?: string;
}

export interface RegisterRequest {
  email: string;
  visitor_id?: string; // Um Guest Session zu verknÃ¼pfen
  utm_source?: string;
}

// ============================================================================
// RESPONSE TYPES
// ============================================================================

export interface Task {
  id: string;
  exam_year: number;
  exam_type: 'zap1' | 'zap2' | 'zap3';
  subject: 'math' | 'german_grammar' | 'german_essay';
  topic: string;
  subtopic?: string;
  difficulty: 1 | 2 | 3 | 4 | 5;
  question_html: string;
  question_image_url?: string;
  answer_type: 'number' | 'text' | 'multiple_choice' | 'multiple_select';
  options?: string[]; // FÃ¼r Multiple Choice
  hints: string[];
  avg_time_seconds: number;
  success_rate: number;
  attempt_count: number;
}

export interface TaskWithSolution extends Task {
  correct_answer: AnswerValue;
  solution_text?: string;
  solution_video_url?: string;
  solution_steps?: SolutionStep[];
}

export interface SolutionStep {
  step_number: number;
  title: string;
  explanation: string;
  formula?: string;
}

export type AnswerValue =
  | { type: 'number'; value: number; unit?: string }
  | { type: 'text'; value: string }
  | { type: 'multiple_choice'; selected_index: number }
  | { type: 'multiple_select'; selected_indices: number[] };

export interface ChallengeResult {
  session_id: string;
  is_correct: boolean;
  correct_answer: AnswerValue;
  time_seconds: number;
  xp_earned: number;

  // Ranking
  percentile: number; // "Schneller als X% der Teilnehmer"
  rank_in_task: number;
  total_attempts: number;
  avg_time_seconds: number;

  // Streak
  streak_current: number;
  streak_bonus: number;

  // Badges (neu verdiente)
  new_badges: Badge[];

  // Level Up?
  level_up?: {
    old_level: number;
    new_level: number;
    level_name: string;
  };

  // Gates (fÃ¼r GÃ¤ste)
  requires_registration: boolean;
  free_results_remaining: number;
}

export interface Invite {
  id: string;
  task_id: string;
  task: Task;

  challenger: {
    email: string;
    display_name?: string;
    avatar_url?: string;
    time_seconds: number;
    is_correct: boolean;
  };

  opponent?: {
    email: string;
    display_name?: string;
    avatar_url?: string;
    time_seconds?: number;
    is_correct?: boolean;
  };

  status: 'pending' | 'accepted' | 'completed' | 'expired';
  winner_email?: string;
  custom_message?: string;

  created_at: string;
  expires_at: string;
}

export interface LeaderboardEntry {
  rank: number;
  player_id: string;
  display_name: string;
  avatar_url?: string;
  correct_count: number;
  avg_time: number;
  best_time: number;
  xp: number;
  is_current_user: boolean;
}

export interface UserProfile {
  id: string;
  email: string;
  display_name?: string;
  avatar_url?: string;
  role: 'student' | 'teacher' | 'parent' | 'admin';

  // Stats
  xp_total: number;
  level: number;
  level_name: string;
  xp_to_next_level: number;
  streak_current: number;
  streak_best: number;

  // Counts
  total_challenges: number;
  correct_challenges: number;
  accuracy: number;

  // Subscription
  subscription: {
    tier: 'free' | 'monthly' | 'half_yearly' | 'yearly';
    status: 'active' | 'cancelled' | 'expired' | 'trial';
    ends_at?: string;
  };

  // Badges
  badges: Badge[];
  badges_count: number;
}

export interface Badge {
  id: string;
  name: string;
  description: string;
  icon: string;
  category: 'beginner' | 'advanced' | 'legendary';
  earned_at?: string;
}

export interface GuestSession {
  visitor_id: string;
  free_results_used: number;
  free_videos_used: number;
  free_exams_used: number;

  // Limits
  max_free_results: 1;
  max_free_videos: 1;
  max_free_exams: 1;
}

// ============================================================================
// ERROR TYPES
// ============================================================================

export interface ApiError {
  code: string;
  message: string;
  details?: Record<string, unknown>;
}

export type ApiResponse<T> =
  | { success: true; data: T }
  | { success: false; error: ApiError };

```

### 3.3 API Route Implementierungen

```tsx
// app/api/challenges/submit/route.ts

import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { z } from 'zod';
import { calculateXP, checkBadges, sendInviteNotification } from '@/lib/challenge';
import { trackEvent } from '@/lib/posthog';

const submitSchema = z.object({
  task_id: z.string(),
  answer: z.object({
    type: z.enum(['number', 'text', 'multiple_choice', 'multiple_select']),
    value: z.unknown(),
  }),
  time_seconds: z.number().min(1).max(3600),
  hints_used: z.number().optional().default(0),
  visitor_id: z.string().optional(),
  source: z.enum(['web', 'embed', 'app', 'wordpress']).optional().default('web'),
  utm_source: z.string().optional(),
  utm_medium: z.string().optional(),
  utm_campaign: z.string().optional(),
  embed_host: z.string().optional(),
  invite_id: z.string().uuid().optional(),
});

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
    const input = submitSchema.parse(body);

    const supabase = createClient();

    // Get current user (optional)
    const { data: { user } } = await supabase.auth.getUser();

    // Validate: Either user or visitor_id must exist
    if (!user && !input.visitor_id) {
      return NextResponse.json({
        success: false,
        error: { code: 'AUTH_REQUIRED', message: 'User or visitor_id required' }
      }, { status: 400 });
    }

    // Fetch task with correct answer
    const { data: task, error: taskError } = await supabase
      .from('tasks')
      .select('*')
      .eq('id', input.task_id)
      .single();

    if (taskError || !task) {
      return NextResponse.json({
        success: false,
        error: { code: 'TASK_NOT_FOUND', message: 'Task not found' }
      }, { status: 404 });
    }

    // Validate answer
    const isCorrect = validateAnswer(input.answer, task.correct_answer);

    // Get user's current streak (if logged in)
    let currentStreak = 0;
    if (user) {
      const { data: profile } = await supabase
        .from('profiles')
        .select('streak_current')
        .eq('id', user.id)
        .single();
      currentStreak = profile?.streak_current || 0;
    }

    // Check if this is a daily challenge
    const { data: dailyChallenge } = await supabase
      .from('daily_challenges')
      .select('*')
      .eq('task_id', input.task_id)
      .eq('challenge_date', new Date().toISOString().split('T')[0])
      .single();

    // Calculate XP
    const xpEarned = calculateXP({
      isCorrect,
      timeSeconds: input.time_seconds,
      avgTime: task.avg_time_seconds || 60,
      streak: currentStreak,
      isDaily: !!dailyChallenge,
      hintsUsed: input.hints_used,
    });

    // Insert session
    const { data: session, error: sessionError } = await supabase
      .from('challenge_sessions')
      .insert({
        user_id: user?.id || null,
        visitor_id: user ? null : input.visitor_id,
        task_id: input.task_id,
        answer: input.answer,
        is_correct: isCorrect,
        time_seconds: input.time_seconds,
        hints_used: input.hints_used,
        xp_earned: xpEarned,
        streak_at_time: currentStreak,
        source: input.source,
        utm_source: input.utm_source,
        utm_medium: input.utm_medium,
        utm_campaign: input.utm_campaign,
        embed_host: input.embed_host,
        invite_id: input.invite_id,
      })
      .select()
      .single();

    if (sessionError) {
      throw sessionError;
    }

    // Calculate percentile
    const { data: rankData } = await supabase
      .rpc('get_task_percentile', {
        p_task_id: input.task_id,
        p_time_seconds: input.time_seconds,
      });

    // Check for new badges (if logged in)
    let newBadges: Badge[] = [];
    let levelUp = null;

    if (user && isCorrect) {
      newBadges = await checkBadges(supabase, user.id);

      // Check for level up
      const { data: updatedProfile } = await supabase
        .from('profiles')
        .select('level, xp_total')
        .eq('id', user.id)
        .single();

      const oldLevel = getLevelFromXP(updatedProfile.xp_total - xpEarned);
      const newLevel = updatedProfile.level;

      if (newLevel > oldLevel) {
        levelUp = {
          old_level: oldLevel,
          new_level: newLevel,
          level_name: LEVEL_NAMES[newLevel],
        };
      }
    }

    // Update invite if this is a duel response
    if (input.invite_id) {
      await supabase
        .from('challenge_invites')
        .update({
          opponent_session_id: session.id,
          opponent_time_seconds: input.time_seconds,
          status: 'completed',
          completed_at: new Date().toISOString(),
          winner_email: determineWinner(/* ... */),
        })
        .eq('id', input.invite_id);

      // Notify challenger
      await sendInviteNotification(input.invite_id, 'completed');
    }

    // Track analytics
    trackEvent('challenge_completed', {
      task_id: input.task_id,
      is_correct: isCorrect,
      time_seconds: input.time_seconds,
      source: input.source,
      utm_source: input.utm_source,
      is_guest: !user,
      xp_earned: xpEarned,
    });

    // Check guest limits
    let requiresRegistration = false;
    let freeResultsRemaining = 1;

    if (!user && input.visitor_id) {
      const { data: guestSession } = await supabase
        .from('guest_sessions')
        .select('free_results_used')
        .eq('visitor_id', input.visitor_id)
        .single();

      if (guestSession) {
        freeResultsRemaining = Math.max(0, 1 - guestSession.free_results_used);
        requiresRegistration = guestSession.free_results_used >= 1;

        // Increment counter
        await supabase
          .from('guest_sessions')
          .update({
            free_results_used: guestSession.free_results_used + 1,
            last_seen_at: new Date().toISOString(),
          })
          .eq('visitor_id', input.visitor_id);
      } else {
        // Create guest session
        await supabase
          .from('guest_sessions')
          .insert({
            visitor_id: input.visitor_id,
            free_results_used: 1,
            utm_source: input.utm_source,
          });
      }
    }

    // Build response
    const result: ChallengeResult = {
      session_id: session.id,
      is_correct: isCorrect,
      correct_answer: task.correct_answer,
      time_seconds: input.time_seconds,
      xp_earned: xpEarned,

      percentile: rankData?.percentile || 50,
      rank_in_task: rankData?.rank || 0,
      total_attempts: task.attempt_count + 1,
      avg_time_seconds: task.avg_time_seconds || 60,

      streak_current: isCorrect ? currentStreak + 1 : 0,
      streak_bonus: xpEarned > 100 ? xpEarned - 100 : 0,

      new_badges: newBadges,
      level_up: levelUp,

      requires_registration: requiresRegistration,
      free_results_remaining: freeResultsRemaining,
    };

    return NextResponse.json({ success: true, data: result });

  } catch (error) {
    console.error('Challenge submit error:', error);

    if (error instanceof z.ZodError) {
      return NextResponse.json({
        success: false,
        error: {
          code: 'VALIDATION_ERROR',
          message: 'Invalid input',
          details: error.errors,
        }
      }, { status: 400 });
    }

    return NextResponse.json({
      success: false,
      error: { code: 'INTERNAL_ERROR', message: 'An error occurred' }
    }, { status: 500 });
  }
}

// Helper functions
function validateAnswer(submitted: AnswerValue, correct: CorrectAnswer): boolean {
  switch (submitted.type) {
    case 'number':
      const tolerance = correct.tolerance || 0;
      return Math.abs(submitted.value - correct.value) <= tolerance;

    case 'text':
      // Simple text comparison (could be enhanced with fuzzy matching)
      return submitted.value.toLowerCase().trim() === correct.value.toLowerCase().trim();

    case 'multiple_choice':
      return submitted.selected_index === correct.correct_index;

    case 'multiple_select':
      const correctSet = new Set(correct.correct_indices);
      const submittedSet = new Set(submitted.selected_indices);
      return correctSet.size === submittedSet.size &&
             [...correctSet].every(i => submittedSet.has(i));

    default:
      return false;
  }
}

const LEVEL_NAMES: Record<number, string> = {
  1: 'AnfÃ¤nger',
  2: 'Aufsteiger',
  3: 'ProblemlÃ¶ser',
  4: 'Mathe-Talent',
  5: 'Gymi-Ready',
  6: 'PrÃ¼fungs-Pro',
  7: 'Challenge-Master',
};

```

```tsx
// app/api/invites/route.ts

import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { Resend } from 'resend';
import { z } from 'zod';
import { ChallengeInviteEmail } from '@/emails/challenge-invite';

const resend = new Resend(process.env.RESEND_API_KEY);

const inviteSchema = z.object({
  task_id: z.string(),
  session_id: z.string().uuid(),
  challenger_email: z.string().email(),
  opponent_email: z.string().email(),
  custom_message: z.string().max(200).optional(),
});

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
    const input = inviteSchema.parse(body);

    // Prevent self-challenge
    if (input.challenger_email.toLowerCase() === input.opponent_email.toLowerCase()) {
      return NextResponse.json({
        success: false,
        error: { code: 'SELF_CHALLENGE', message: 'Cannot challenge yourself' }
      }, { status: 400 });
    }

    const supabase = createClient();

    // Get challenger's session
    const { data: session, error: sessionError } = await supabase
      .from('challenge_sessions')
      .select('*, tasks(*)')
      .eq('id', input.session_id)
      .single();

    if (sessionError || !session) {
      return NextResponse.json({
        success: false,
        error: { code: 'SESSION_NOT_FOUND', message: 'Challenge session not found' }
      }, { status: 404 });
    }

    // Check for existing pending invite
    const { data: existingInvite } = await supabase
      .from('challenge_invites')
      .select('id')
      .eq('task_id', input.task_id)
      .eq('challenger_email', input.challenger_email)
      .eq('opponent_email', input.opponent_email)
      .eq('status', 'pending')
      .single();

    if (existingInvite) {
      return NextResponse.json({
        success: false,
        error: { code: 'INVITE_EXISTS', message: 'Challenge already sent' }
      }, { status: 409 });
    }

    // Check if challenger is registered
    const { data: challengerProfile } = await supabase
      .from('profiles')
      .select('id, display_name')
      .eq('email', input.challenger_email)
      .single();

    // Create invite
    const { data: invite, error: inviteError } = await supabase
      .from('challenge_invites')
      .insert({
        task_id: input.task_id,
        challenger_email: input.challenger_email,
        challenger_user_id: challengerProfile?.id || null,
        challenger_session_id: input.session_id,
        challenger_time_seconds: session.time_seconds,
        opponent_email: input.opponent_email,
        custom_message: input.custom_message,
        status: 'pending',
        expires_at: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString(), // 7 days
      })
      .select()
      .single();

    if (inviteError) {
      throw inviteError;
    }

    // Send email
    const challengeUrl = `${process.env.NEXT_PUBLIC_APP_URL}/challenge/${invite.invite_token}`;

    await resend.emails.send({
      from: 'GoGymi Challenge <challenge@gogymi.ch>',
      to: input.opponent_email,
      subject: `ðŸŽ¯ ${challengerProfile?.display_name || 'Jemand'} hat dich zur GymiprÃ¼fung herausgefordert!`,
      react: ChallengeInviteEmail({
        challengerName: challengerProfile?.display_name || input.challenger_email.split('@')[0],
        challengerTime: session.time_seconds,
        taskTitle: getTaskTitle(session.tasks),
        customMessage: input.custom_message,
        challengeUrl,
      }),
    });

    // Update invite with sent timestamp
    await supabase
      .from('challenge_invites')
      .update({ sent_at: new Date().toISOString() })
      .eq('id', invite.id);

    // If challenger provided email, capture it
    if (!challengerProfile) {
      await supabase
        .from('guest_sessions')
        .upsert({
          visitor_id: session.visitor_id,
          email_captured: input.challenger_email,
        }, {
          onConflict: 'visitor_id',
        });
    }

    return NextResponse.json({
      success: true,
      data: {
        invite_id: invite.id,
        invite_token: invite.invite_token,
        expires_at: invite.expires_at,
      }
    });

  } catch (error) {
    console.error('Create invite error:', error);

    if (error instanceof z.ZodError) {
      return NextResponse.json({
        success: false,
        error: {
          code: 'VALIDATION_ERROR',
          message: 'Invalid input',
          details: error.errors,
        }
      }, { status: 400 });
    }

    return NextResponse.json({
      success: false,
      error: { code: 'INTERNAL_ERROR', message: 'An error occurred' }
    }, { status: 500 });
  }
}

function getTaskTitle(task: Task): string {
  const subjects: Record<string, string> = {
    math: 'Mathematik',
    german_grammar: 'Deutsch Grammatik',
    german_essay: 'Deutsch Aufsatz',
  };

  return `${subjects[task.subject]} - ${task.topic} (${task.exam_year})`;
}

```

---

## 4. Frontend Architecture

### 4.1 Komponenten-Hierarchie

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           COMPONENT HIERARCHY                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

app/
â”œâ”€â”€ layout.tsx                          # Root Layout
â”‚   â””â”€â”€ Providers                       # Theme, Auth, Analytics
â”‚
â”œâ”€â”€ (public)/                           # Ã–ffentliche Routen
â”‚   â”œâ”€â”€ layout.tsx                      # Minimal Header
â”‚   â”‚
â”‚   â”œâ”€â”€ challenge/
â”‚   â”‚   â”œâ”€â”€ page.tsx                    # Landing â†’ Random Task
â”‚   â”‚   â””â”€â”€ [taskId]/
â”‚   â”‚       â””â”€â”€ page.tsx                # Challenge Page
â”‚   â”‚           â”œâ”€â”€ TaskCard            # Aufgaben-Anzeige
â”‚   â”‚           â”œâ”€â”€ AnswerInput         # Input je nach Type
â”‚   â”‚           â”œâ”€â”€ Timer               # Countdown
â”‚   â”‚           â””â”€â”€ ResultScreen        # Ergebnis + Actions
â”‚   â”‚
â”‚   â”œâ”€â”€ duel/
â”‚   â”‚   â””â”€â”€ [token]/
â”‚   â”‚       â””â”€â”€ page.tsx                # Duell-Seite
â”‚   â”‚           â”œâ”€â”€ DuelHeader          # VS-Anzeige
â”‚   â”‚           â”œâ”€â”€ TaskCard
â”‚   â”‚           â””â”€â”€ DuelResult          # Gewinner-Anzeige
â”‚   â”‚
â”‚   â””â”€â”€ embed/
â”‚       â””â”€â”€ [taskId]/
â”‚           â””â”€â”€ page.tsx                # Embed Version
â”‚               â””â”€â”€ EmbedChallenge      # Kompakte Version
â”‚
â”œâ”€â”€ (auth)/                             # Auth Routen
â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”œâ”€â”€ register/page.tsx
â”‚   â””â”€â”€ verify/page.tsx
â”‚
â””â”€â”€ (dashboard)/                        # GeschÃ¼tzte Routen
    â”œâ”€â”€ layout.tsx                      # Dashboard Layout + Nav
    â”‚
    â”œâ”€â”€ page.tsx                        # Dashboard Home
    â”‚   â”œâ”€â”€ StatsOverview
    â”‚   â”œâ”€â”€ RecentActivity
    â”‚   â””â”€â”€ DailyChallenge
    â”‚
    â”œâ”€â”€ challenges/
    â”‚   â””â”€â”€ page.tsx
    â”‚       â”œâ”€â”€ ChallengeFilters
    â”‚       â””â”€â”€ ChallengeGrid
    â”‚
    â”œâ”€â”€ leaderboard/
    â”‚   â””â”€â”€ page.tsx
    â”‚       â”œâ”€â”€ LeaderboardTabs
    â”‚       â””â”€â”€ LeaderboardTable
    â”‚
    â”œâ”€â”€ invites/
    â”‚   â””â”€â”€ page.tsx
    â”‚       â”œâ”€â”€ PendingInvites
    â”‚       â””â”€â”€ CompletedDuels
    â”‚
    â””â”€â”€ profile/
        â””â”€â”€ page.tsx
            â”œâ”€â”€ ProfileHeader
            â”œâ”€â”€ BadgeCollection
            â””â”€â”€ StatsGrid

```

### 4.2 State Management

```tsx
// stores/challenge-store.ts

import { create } from 'zustand';
import { persist } from 'zustand/middleware';

interface ChallengeState {
  // Current Challenge
  currentTask: Task | null;
  isLoading: boolean;
  error: string | null;

  // Timer
  timerStarted: boolean;
  elapsedSeconds: number;

  // Answer
  answer: AnswerValue | null;
  isSubmitting: boolean;

  // Result
  result: ChallengeResult | null;

  // Guest Session
  visitorId: string | null;
  guestSession: GuestSession | null;

  // Actions
  startChallenge: (taskId: string) => Promise<void>;
  startTimer: () => void;
  stopTimer: () => void;
  setAnswer: (answer: AnswerValue) => void;
  submitAnswer: () => Promise<ChallengeResult>;
  resetChallenge: () => void;

  // Guest
  initGuestSession: () => void;
  incrementGuestUsage: (type: 'results' | 'videos' | 'exams') => void;
}

export const useChallengeStore = create<ChallengeState>()(
  persist(
    (set, get) => ({
      // Initial State
      currentTask: null,
      isLoading: false,
      error: null,
      timerStarted: false,
      elapsedSeconds: 0,
      answer: null,
      isSubmitting: false,
      result: null,
      visitorId: null,
      guestSession: null,

      // Actions
      startChallenge: async (taskId: string) => {
        set({ isLoading: true, error: null, result: null });

        try {
          const response = await fetch(`/api/tasks/${taskId}`);
          const { data, error } = await response.json();

          if (error) throw new Error(error.message);

          set({
            currentTask: data,
            isLoading: false,
            elapsedSeconds: 0,
            answer: null,
          });
        } catch (error) {
          set({
            error: error.message,
            isLoading: false,
          });
        }
      },

      startTimer: () => {
        set({ timerStarted: true });

        const interval = setInterval(() => {
          const { timerStarted, elapsedSeconds } = get();
          if (timerStarted) {
            set({ elapsedSeconds: elapsedSeconds + 1 });
          } else {
            clearInterval(interval);
          }
        }, 1000);
      },

      stopTimer: () => {
        set({ timerStarted: false });
      },

      setAnswer: (answer: AnswerValue) => {
        set({ answer });
      },

      submitAnswer: async () => {
        const { currentTask, answer, elapsedSeconds, visitorId } = get();

        if (!currentTask || !answer) {
          throw new Error('No task or answer');
        }

        set({ isSubmitting: true, timerStarted: false });

        try {
          const response = await fetch('/api/challenges/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              task_id: currentTask.id,
              answer,
              time_seconds: elapsedSeconds,
              visitor_id: visitorId,
              source: 'web',
            }),
          });

          const { data, error } = await response.json();

          if (error) throw new Error(error.message);

          set({
            result: data,
            isSubmitting: false,
          });

          return data;
        } catch (error) {
          set({ isSubmitting: false });
          throw error;
        }
      },

      resetChallenge: () => {
        set({
          currentTask: null,
          timerStarted: false,
          elapsedSeconds: 0,
          answer: null,
          result: null,
        });
      },

      initGuestSession: () => {
        let visitorId = get().visitorId;

        if (!visitorId) {
          visitorId = `guest_${crypto.randomUUID()}`;
          set({
            visitorId,
            guestSession: {
              visitor_id: visitorId,
              free_results_used: 0,
              free_videos_used: 0,
              free_exams_used: 0,
              max_free_results: 1,
              max_free_videos: 1,
              max_free_exams: 1,
            },
          });
        }
      },

      incrementGuestUsage: (type) => {
        const { guestSession } = get();
        if (!guestSession) return;

        set({
          guestSession: {
            ...guestSession,
            [`free_${type}_used`]: guestSession[`free_${type}_used`] + 1,
          },
        });
      },
    }),
    {
      name: 'gogymi-challenge',
      partialize: (state) => ({
        visitorId: state.visitorId,
        guestSession: state.guestSession,
      }),
    }
  )
);

```

### 4.3 Haupt-Komponenten

```tsx
// components/challenge/task-card.tsx

'use client';

import { useState, useEffect } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Timer } from './timer';
import { AnswerInput } from './answer-input';
import { Button } from '@/components/ui/button';
import { useChallengeStore } from '@/stores/challenge-store';
import { cn } from '@/lib/utils';

interface TaskCardProps {
  task: Task;
  onSubmit: () => void;
  isSubmitting: boolean;
}

export function TaskCard({ task, onSubmit, isSubmitting }: TaskCardProps) {
  const {
    answer,
    setAnswer,
    timerStarted,
    startTimer,
    elapsedSeconds
  } = useChallengeStore();

  const [showHint, setShowHint] = useState(false);
  const [hintsUsed, setHintsUsed] = useState(0);

  // Start timer on mount
  useEffect(() => {
    startTimer();
  }, []);

  const difficultyColors = {
    1: 'bg-green-100 text-green-800',
    2: 'bg-lime-100 text-lime-800',
    3: 'bg-yellow-100 text-yellow-800',
    4: 'bg-orange-100 text-orange-800',
    5: 'bg-red-100 text-red-800',
  };

  const difficultyLabels = {
    1: 'Einfach',
    2: 'Leicht',
    3: 'Mittel',
    4: 'Schwer',
    5: 'Sehr schwer',
  };

  const handleHint = () => {
    if (hintsUsed < task.hints.length) {
      setShowHint(true);
      setHintsUsed(hintsUsed + 1);
    }
  };

  const canSubmit = answer !== null && !isSubmitting;

  return (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-4">
        <div className="flex items-center gap-2">
          <Badge variant="outline">
            {task.exam_type.toUpperCase()} {task.exam_year}
          </Badge>
          <Badge className={cn(difficultyColors[task.difficulty])}>
            {difficultyLabels[task.difficulty]}
          </Badge>
        </div>
        <Timer
          seconds={elapsedSeconds}
          isRunning={timerStarted}
          avgTime={task.avg_time_seconds}
        />
      </CardHeader>

      <CardContent className="space-y-6">
        {/* Question */}
        <div
          className="prose prose-lg max-w-none"
          dangerouslySetInnerHTML={{ __html: task.question_html }}
        />

        {/* Question Image */}
        {task.question_image_url && (
          <div className="flex justify-center">
            <img
              src={task.question_image_url}
              alt="Aufgabenbild"
              className="max-w-full h-auto rounded-lg border"
            />
          </div>
        )}

        {/* Answer Input */}
        <div className="pt-4 border-t">
          <AnswerInput
            type={task.answer_type}
            options={task.options}
            value={answer}
            onChange={setAnswer}
            disabled={isSubmitting}
          />
        </div>

        {/* Hint */}
        {task.hints.length > 0 && (
          <div className="pt-4">
            {showHint ? (
              <div className="p-4 bg-blue-50 rounded-lg border border-blue-200">
                <p className="text-sm font-medium text-blue-800 mb-1">
                  ðŸ’¡ Tipp {hintsUsed}/{task.hints.length}
                </p>
                <p className="text-blue-700">
                  {task.hints[hintsUsed - 1]}
                </p>
              </div>
            ) : (
              <Button
                variant="ghost"
                size="sm"
                onClick={handleHint}
                className="text-blue-600"
              >
                ðŸ’¡ Tipp anzeigen ({task.hints.length - hintsUsed} Ã¼brig)
              </Button>
            )}
          </div>
        )}

        {/* Submit */}
        <div className="pt-4">
          <Button
            onClick={onSubmit}
            disabled={!canSubmit}
            className="w-full"
            size="lg"
          >
            {isSubmitting ? (
              <>
                <span className="animate-spin mr-2">â³</span>
                Wird geprÃ¼ft...
              </>
            ) : (
              'Antwort prÃ¼fen â†’'
            )}
          </Button>
        </div>
      </CardContent>
    </Card>
  );
}

```

```tsx
// components/challenge/result-screen.tsx

'use client';

import { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import confetti from 'canvas-confetti';
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Progress } from '@/components/ui/progress';
import { Badge } from '@/components/ui/badge';
import { RegistrationGate } from './registration-gate';
import { ChallengeInviteForm } from './challenge-invite-form';
import { cn } from '@/lib/utils';

interface ResultScreenProps {
  result: ChallengeResult;
  task: Task;
  onNextChallenge: () => void;
  onViewSolution: () => void;
}

export function ResultScreen({
  result,
  task,
  onNextChallenge,
  onViewSolution,
}: ResultScreenProps) {
  const [showGate, setShowGate] = useState(false);
  const [showInviteForm, setShowInviteForm] = useState(false);
  const [xpAnimated, setXpAnimated] = useState(0);

  // Confetti on correct answer
  useEffect(() => {
    if (result.is_correct) {
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 },
      });
    }
  }, [result.is_correct]);

  // Animate XP counter
  useEffect(() => {
    const duration = 1000;
    const start = Date.now();

    const animate = () => {
      const elapsed = Date.now() - start;
      const progress = Math.min(elapsed / duration, 1);
      setXpAnimated(Math.floor(progress * result.xp_earned));

      if (progress < 1) {
        requestAnimationFrame(animate);
      }
    };

    animate();
  }, [result.xp_earned]);

  // Show gate if needed
  useEffect(() => {
    if (result.requires_registration) {
      setShowGate(true);
    }
  }, [result.requires_registration]);

  const formatTime = (seconds: number) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `${secs} Sek.`;
  };

  return (
    <>
      <Card className="w-full max-w-2xl mx-auto overflow-hidden">
        {/* Header */}
        <div
          className={cn(
            "p-8 text-center text-white",
            result.is_correct
              ? "bg-gradient-to-br from-green-500 to-emerald-600"
              : "bg-gradient-to-br from-red-500 to-rose-600"
          )}
        >
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            transition={{ type: "spring", duration: 0.5 }}
          >
            {result.is_correct ? (
              <>
                <div className="text-6xl mb-4">ðŸŽ‰</div>
                <h2 className="text-3xl font-bold">Richtig!</h2>
              </>
            ) : (
              <>
                <div className="text-6xl mb-4">ðŸ˜…</div>
                <h2 className="text-3xl font-bold">Leider falsch</h2>
              </>
            )}
          </motion.div>

          <p className="mt-2 text-white/80">
            Deine Antwort: {formatAnswer(result.correct_answer)}
          </p>
        </div>

        <CardContent className="p-6 space-y-6">
          {/* Stats Grid */}
          <div className="grid grid-cols-2 gap-4">
            {/* Time */}
            <div className="p-4 bg-muted rounded-lg text-center">
              <p className="text-sm text-muted-foreground">Deine Zeit</p>
              <p className="text-2xl font-bold font-mono">
                {formatTime(result.time_seconds)}
              </p>
              <p className="text-xs text-muted-foreground">
                Ã˜ {formatTime(result.avg_time_seconds)}
              </p>
            </div>

            {/* Ranking */}
            <div className="p-4 bg-muted rounded-lg text-center">
              <p className="text-sm text-muted-foreground">Dein Ranking</p>
              <p className="text-2xl font-bold">
                Top {100 - result.percentile}%
              </p>
              <p className="text-xs text-muted-foreground">
                Schneller als {result.percentile}%
              </p>
            </div>
          </div>

          {/* Progress Bar */}
          <div>
            <div className="flex justify-between text-sm mb-2">
              <span>Langsamer</span>
              <span>Schneller</span>
            </div>
            <Progress value={result.percentile} className="h-3" />
          </div>

          {/* XP Earned */}
          {result.xp_earned > 0 && (
            <motion.div
              className="p-4 bg-yellow-50 border border-yellow-200 rounded-lg"
              initial={{ opacity: 0, y: 20 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: 0.3 }}
            >
              <div className="flex items-center justify-between">
                <div>
                  <p className="font-semibold text-yellow-800">XP verdient</p>
                  <div className="text-sm text-yellow-700 space-y-1">
                    <p>+100 Richtige Antwort</p>
                    {result.streak_bonus > 0 && (
                      <p>+{result.streak_bonus} Streak Bonus ðŸ”¥</p>
                    )}
                  </div>
                </div>
                <div className="text-4xl font-bold text-yellow-600 font-mono">
                  +{xpAnimated}
                </div>
              </div>
            </motion.div>
          )}

          {/* Streak */}
          {result.streak_current > 0 && (
            <motion.div
              className="flex items-center justify-center gap-2 p-3 bg-orange-50 rounded-lg"
              initial={{ scale: 0.8, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              transition={{ delay: 0.5 }}
            >
              <span className="text-2xl">ðŸ”¥</span>
              <span className="font-bold text-orange-600">
                {result.streak_current}er Streak!
              </span>
            </motion.div>
          )}

          {/* New Badges */}
          {result.new_badges.length > 0 && (
            <motion.div
              className="space-y-2"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.7 }}
            >
              <p className="font-semibold">ðŸ… Neues Badge!</p>
              <div className="flex gap-2">
                {result.new_badges.map(badge => (
                  <Badge key={badge.id} variant="secondary" className="py-2 px-3">
                    <span className="mr-1">{badge.icon}</span>
                    {badge.name}
                  </Badge>
                ))}
              </div>
            </motion.div>
          )}

          {/* Level Up */}
          <AnimatePresence>
            {result.level_up && (
              <motion.div
                className="p-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-white text-center"
                initial={{ scale: 0, rotate: -10 }}
                animate={{ scale: 1, rotate: 0 }}
                exit={{ scale: 0 }}
                transition={{ type: "spring" }}
              >
                <p className="text-lg font-bold">â¬†ï¸ LEVEL UP!</p>
                <p>Du bist jetzt: {result.level_up.level_name}</p>
              </motion.div>
            )}
          </AnimatePresence>

          {/* Actions */}
          <div className="space-y-3 pt-4 border-t">
            <div className="grid grid-cols-2 gap-3">
              <Button
                onClick={onNextChallenge}
                className="w-full"
              >
                ðŸŽ¯ NÃ¤chste Aufgabe
              </Button>
              <Button
                variant="outline"
                onClick={onViewSolution}
                className="w-full"
              >
                ðŸ“¹ LÃ¶sungsweg
              </Button>
            </div>

            <Button
              variant="secondary"
              onClick={() => setShowInviteForm(true)}
              className="w-full"
            >
              ðŸ¤ Freund herausfordern
            </Button>
          </div>
        </CardContent>
      </Card>

      {/* Registration Gate Modal */}
      <RegistrationGate
        open={showGate}
        onClose={() => setShowGate(false)}
        freeResultsRemaining={result.free_results_remaining}
      />

      {/* Challenge Invite Modal */}
      <ChallengeInviteForm
        open={showInviteForm}
        onClose={() => setShowInviteForm(false)}
        task={task}
        sessionId={result.session_id}
        challengerTime={result.time_seconds}
      />
    </>
  );
}

function formatAnswer(answer: AnswerValue): string {
  switch (answer.type) {
    case 'number':
      return `${answer.value}${answer.unit ? ` ${answer.unit}` : ''}`;
    case 'text':
      return answer.value;
    case 'multiple_choice':
      return `Option ${answer.selected_index + 1}`;
    case 'multiple_select':
      return `Optionen ${answer.selected_indices.map(i => i + 1).join(', ')}`;
    default:
      return '';
  }
}

```

---

## 5. Email Templates

### 5.1 Challenge Invite Email

```tsx
// emails/challenge-invite.tsx

import {
  Body,
  Button,
  Container,
  Head,
  Heading,
  Hr,
  Html,
  Img,
  Preview,
  Section,
  Text,
} from '@react-email/components';

interface ChallengeInviteEmailProps {
  challengerName: string;
  challengerTime: number;
  taskTitle: string;
  customMessage?: string;
  challengeUrl: string;
}

export function ChallengeInviteEmail({
  challengerName,
  challengerTime,
  taskTitle,
  customMessage,
  challengeUrl,
}: ChallengeInviteEmailProps) {
  const formatTime = (seconds: number) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `${secs} Sekunden`;
  };

  return (
    <Html>
      <Head />
      <Preview>
        {challengerName} hat dich zur GymiprÃ¼fung herausgefordert! ðŸŽ¯
      </Preview>
      <Body style={main}>
        <Container style={container}>
          {/* Logo */}
          <Img
            src="https://gogymi.ch/logo.png"
            width="120"
            height="40"
            alt="GoGymi"
            style={logo}
          />

          {/* Header */}
          <Heading style={heading}>
            ðŸŽ¯ Du wurdest herausgefordert!
          </Heading>

          {/* Content */}
          <Text style={paragraph}>
            <strong>{challengerName}</strong> hat eine Aufgabe aus der GymiprÃ¼fung gelÃ¶st
            und will wissen, ob du das auch schaffst!
          </Text>

          {/* Stats Box */}
          <Section style={statsBox}>
            <Text style={statsLabel}>Aufgabe</Text>
            <Text style={statsValue}>{taskTitle}</Text>

            <Text style={statsLabel}>Zeit von {challengerName}</Text>
            <Text style={statsValue}>{formatTime(challengerTime)}</Text>
          </Section>

          {/* Custom Message */}
          {customMessage && (
            <Section style={messageBox}>
              <Text style={messageLabel}>Nachricht von {challengerName}:</Text>
              <Text style={messageText}>"{customMessage}"</Text>
            </Section>
          )}

          {/* CTA Button */}
          <Section style={buttonContainer}>
            <Button style={button} href={challengeUrl}>
              Challenge annehmen â†’
            </Button>
          </Section>

          <Text style={subtext}>
            Zeig, was du drauf hast! Schaffst du es schneller?
          </Text>

          <Hr style={hr} />

          {/* Footer */}
          <Text style={footer}>
            GoGymi â€“ Die Lernplattform fÃ¼r die GymiprÃ¼fung
          </Text>
          <Text style={footerSmall}>
            Diese Email wurde gesendet, weil jemand dich zu einer Challenge eingeladen hat.
            Du kannst diese Einladung ignorieren.
          </Text>
        </Container>
      </Body>
    </Html>
  );
}

// Styles
const main = {
  backgroundColor: '#f6f9fc',
  fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
};

const container = {
  backgroundColor: '#ffffff',
  margin: '0 auto',
  padding: '40px 20px',
  maxWidth: '560px',
  borderRadius: '8px',
};

const logo = {
  margin: '0 auto 24px',
  display: 'block',
};

const heading = {
  color: '#1a1a1a',
  fontSize: '28px',
  fontWeight: '700',
  textAlign: 'center' as const,
  margin: '0 0 24px',
};

const paragraph = {
  color: '#4a4a4a',
  fontSize: '16px',
  lineHeight: '26px',
  margin: '0 0 24px',
};

const statsBox = {
  backgroundColor: '#f0f4ff',
  borderRadius: '8px',
  padding: '20px',
  margin: '0 0 24px',
};

const statsLabel = {
  color: '#6b7280',
  fontSize: '12px',
  fontWeight: '600',
  textTransform: 'uppercase' as const,
  margin: '0 0 4px',
};

const statsValue = {
  color: '#1a1a1a',
  fontSize: '18px',
  fontWeight: '700',
  margin: '0 0 16px',
};

const messageBox = {
  backgroundColor: '#fef3c7',
  borderRadius: '8px',
  padding: '16px',
  margin: '0 0 24px',
};

const messageLabel = {
  color: '#92400e',
  fontSize: '12px',
  fontWeight: '600',
  margin: '0 0 8px',
};

const messageText = {
  color: '#78350f',
  fontSize: '16px',
  fontStyle: 'italic',
  margin: '0',
};

const buttonContainer = {
  textAlign: 'center' as const,
  margin: '32px 0',
};

const button = {
  backgroundColor: '#3b82f6',
  borderRadius: '8px',
  color: '#ffffff',
  fontSize: '16px',
  fontWeight: '600',
  textDecoration: 'none',
  padding: '14px 32px',
  display: 'inline-block',
};

const subtext = {
  color: '#6b7280',
  fontSize: '14px',
  textAlign: 'center' as const,
  margin: '0 0 24px',
};

const hr = {
  borderColor: '#e5e7eb',
  margin: '24px 0',
};

const footer = {
  color: '#6b7280',
  fontSize: '14px',
  textAlign: 'center' as const,
  margin: '0 0 8px',
};

const footerSmall = {
  color: '#9ca3af',
  fontSize: '12px',
  textAlign: 'center' as const,
  margin: '0',
};

export default ChallengeInviteEmail;

```

---

## 6. WordPress Integration

### 6.1 Shortcode Plugin

```php
<?php
/**
 * Plugin Name: GoGymi Challenge Embed
 * Description: Embed GoGymi Challenge Mode in WordPress
 * Version: 1.0.0
 */

// Prevent direct access
if (!defined('ABSPATH')) {
    exit;
}

class GoGymi_Challenge_Embed {

    private $app_url = 'https://challenge.gogymi.ch';

    public function __construct() {
        add_shortcode('gogymi_challenge', [$this, 'render_shortcode']);
        add_action('wp_enqueue_scripts', [$this, 'enqueue_scripts']);
    }

    /**
     * Render the challenge shortcode
     *
     * Usage:
     * [gogymi_challenge] - Random task
     * [gogymi_challenge task="zap1-2024-math-12"] - Specific task
     * [gogymi_challenge exam_type="zap1" subject="math"] - Filtered random
     * [gogymi_challenge mode="compact"] - Compact version
     */
    public function render_shortcode($atts) {
        $atts = shortcode_atts([
            'task' => '',
            'exam_type' => '',
            'subject' => '',
            'mode' => 'full', // 'full', 'compact', 'embed'
            'theme' => 'light',
            'height' => '600',
        ], $atts);

        // Build URL
        $url = $this->app_url;

        if ($atts['mode'] === 'embed') {
            $url .= '/embed';
        }

        if (!empty($atts['task'])) {
            $url .= '/challenge/' . sanitize_text_field($atts['task']);
        } else {
            $url .= '/challenge';
        }

        // Add query params
        $params = [];

        if (!empty($atts['exam_type'])) {
            $params['exam_type'] = sanitize_text_field($atts['exam_type']);
        }

        if (!empty($atts['subject'])) {
            $params['subject'] = sanitize_text_field($atts['subject']);
        }

        $params['theme'] = $atts['theme'];
        $params['source'] = 'wordpress';
        $params['utm_source'] = get_bloginfo('name');

        // Pass user ID if logged in
        if (is_user_logged_in()) {
            $current_user = wp_get_current_user();
            $params['wp_user_email'] = $current_user->user_email;
        }

        $url .= '?' . http_build_query($params);

        // Generate unique ID
        $iframe_id = 'gogymi-challenge-' . uniqid();

        // Render iframe
        $height = intval($atts['height']);

        $html = sprintf(
            '<div class="gogymi-challenge-wrapper" style="width:100%%;max-width:800px;margin:0 auto;">
                <iframe
                    id="%s"
                    src="%s"
                    width="100%%"
                    height="%dpx"
                    frameborder="0"
                    allow="clipboard-write"
                    style="border:none;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);"
                    loading="lazy"
                ></iframe>
            </div>',
            esc_attr($iframe_id),
            esc_url($url),
            $height
        );

        return $html;
    }

    /**
     * Enqueue scripts for iframe resizing
     */
    public function enqueue_scripts() {
        wp_enqueue_script(
            'gogymi-iframe-resizer',
            plugins_url('js/iframe-resizer.js', __FILE__),
            [],
            '1.0.0',
            true
        );
    }
}

// Initialize plugin
new GoGymi_Challenge_Embed();

```

### 6.2 Auth Bridge (Optional)

```php
// gogymi-auth-bridge.php

/**
 * Sync WordPress users with GoGymi
 */
class GoGymi_Auth_Bridge {

    private $api_url = 'https://challenge.gogymi.ch/api';
    private $api_key;

    public function __construct() {
        $this->api_key = get_option('gogymi_api_key');

        // Sync on login
        add_action('wp_login', [$this, 'sync_user_on_login'], 10, 2);

        // Sync on registration
        add_action('user_register', [$this, 'sync_user_on_register']);

        // Add SSO endpoint
        add_action('rest_api_init', [$this, 'register_sso_endpoint']);
    }

    /**
     * Sync user to GoGymi on login
     */
    public function sync_user_on_login($user_login, $user) {
        $this->sync_user($user);
    }

    /**
     * Sync user to GoGymi on registration
     */
    public function sync_user_on_register($user_id) {
        $user = get_user_by('id', $user_id);
        $this->sync_user($user);
    }

    /**
     * Sync user data to GoGymi
     */
    private function sync_user($user) {
        $response = wp_remote_post($this->api_url . '/auth/wordpress-sync', [
            'headers' => [
                'Authorization' => 'Bearer ' . $this->api_key,
                'Content-Type' => 'application/json',
            ],
            'body' => json_encode([
                'email' => $user->user_email,
                'display_name' => $user->display_name,
                'wordpress_user_id' => $user->ID,
                'role' => $this->map_role($user->roles),
            ]),
        ]);

        if (is_wp_error($response)) {
            error_log('GoGymi sync error: ' . $response->get_error_message());
        }
    }

    /**
     * Map WordPress roles to GoGymi roles
     */
    private function map_role($roles) {
        if (in_array('administrator', $roles)) {
            return 'admin';
        }
        if (in_array('gogymi_teacher', $roles)) {
            return 'teacher';
        }
        if (in_array('gogymi_parent', $roles)) {
            return 'parent';
        }
        return 'student';
    }

    /**
     * Register SSO endpoint
     */
    public function register_sso_endpoint() {
        register_rest_route('gogymi/v1', '/sso-token', [
            'methods' => 'GET',
            'callback' => [$this, 'generate_sso_token'],
            'permission_callback' => function() {
                return is_user_logged_in();
            },
        ]);
    }

    /**
     * Generate SSO token for seamless login
     */
    public function generate_sso_token($request) {
        $user = wp_get_current_user();

        $token_data = [
            'email' => $user->user_email,
            'display_name' => $user->display_name,
            'exp' => time() + 300, // 5 minutes
        ];

        // Sign with shared secret
        $token = $this->sign_token($token_data);

        return new WP_REST_Response([
            'token' => $token,
            'redirect_url' => 'https://challenge.gogymi.ch/auth/sso?token=' . $token,
        ]);
    }

    private function sign_token($data) {
        $secret = get_option('gogymi_sso_secret');
        $payload = base64_encode(json_encode($data));
        $signature = hash_hmac('sha256', $payload, $secret);
        return $payload . '.' . $signature;
    }
}

new GoGymi_Auth_Bridge();

```

---

## 7. Deployment & DevOps

### 7.1 Vercel Configuration

```json
// vercel.json
{
  "framework": "nextjs",
  "regions": ["fra1"], // Frankfurt (nÃ¤her an ZÃ¼rich)
  "functions": {
    "app/api/**/*.ts": {
      "maxDuration": 30
    }
  },
  "crons": [
    {
      "path": "/api/cron/daily-challenge",
      "schedule": "0 0 * * *"
    },
    {
      "path": "/api/cron/expire-invites",
      "schedule": "0 */6 * * *"
    },
    {
      "path": "/api/cron/update-stats",
      "schedule": "*/15 * * * *"
    }
  ],
  "headers": [
    {
      "source": "/embed/(.*)",
      "headers": [
        {
          "key": "X-Frame-Options",
          "value": "ALLOWALL"
        },
        {
          "key": "Content-Security-Policy",
          "value": "frame-ancestors *"
        }
      ]
    },
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Access-Control-Allow-Origin",
          "value": "*"
        }
      ]
    }
  ],
  "rewrites": [
    {
      "source": "/c/:token",
      "destination": "/duel/:token"
    }
  ]
}

```

### 7.2 Environment Variables

```bash
# .env.local

# App
NEXT_PUBLIC_APP_URL=https://challenge.gogymi.ch
NEXT_PUBLIC_WORDPRESS_URL=https://gogymi.ch

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...
SUPABASE_SERVICE_ROLE_KEY=eyJ...

# Stripe
STRIPE_SECRET_KEY=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_...

# Resend (Email)
RESEND_API_KEY=re_...

# PostHog (Analytics)
NEXT_PUBLIC_POSTHOG_KEY=phc_...
NEXT_PUBLIC_POSTHOG_HOST=https://eu.posthog.com

# OpenAI (fÃ¼r KI-Tutor spÃ¤ter)
OPENAI_API_KEY=sk-...

# WordPress Integration
WORDPRESS_API_KEY=...
WORDPRESS_SSO_SECRET=...

# Feature Flags
NEXT_PUBLIC_ENABLE_REALTIME_LEADERBOARD=true
NEXT_PUBLIC_ENABLE_DAILY_CHALLENGE=true

```

### 7.3 CI/CD Pipeline

```yaml
# .github/workflows/deploy.yml

name: Deploy

on:
  push:
    branches: [main, staging]
  pull_request:
    branches: [main]

env:
  VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
  VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run linter
        run: npm run lint

      - name: Run type check
        run: npm run type-check

      - name: Run tests
        run: npm run test
        env:
          NEXT_PUBLIC_SUPABASE_URL: ${{ secrets.TEST_SUPABASE_URL }}
          NEXT_PUBLIC_SUPABASE_ANON_KEY: ${{ secrets.TEST_SUPABASE_ANON_KEY }}

  deploy-preview:
    needs: test
    if: github.event_name == 'pull_request'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install Vercel CLI
        run: npm install --global vercel@latest

      - name: Pull Vercel Environment
        run: vercel pull --yes --environment=preview --token=${{ secrets.VERCEL_TOKEN }}

      - name: Build
        run: vercel build --token=${{ secrets.VERCEL_TOKEN }}

      - name: Deploy Preview
        id: deploy
        run: |
          url=$(vercel deploy --prebuilt --token=${{ secrets.VERCEL_TOKEN }})
          echo "url=$url" >> $GITHUB_OUTPUT

      - name: Comment PR
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'ðŸš€ Preview deployed: ${{ steps.deploy.outputs.url }}'
            })

  deploy-production:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install Vercel CLI
        run: npm install --global vercel@latest

      - name: Pull Vercel Environment
        run: vercel pull --yes --environment=production --token=${{ secrets.VERCEL_TOKEN }}

      - name: Build
        run: vercel build --prod --token=${{ secrets.VERCEL_TOKEN }}

      - name: Deploy Production
        run: vercel deploy --prebuilt --prod --token=${{ secrets.VERCEL_TOKEN }}

      - name: Run DB Migrations
        run: npx supabase db push
        env:
          SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
          SUPABASE_PROJECT_ID: ${{ secrets.SUPABASE_PROJECT_ID }}

```

---

## 8. Monitoring & Analytics

### 8.1 PostHog Events

```tsx
// lib/posthog.ts

import posthog from 'posthog-js';

// Event Types
export const EVENTS = {
  // Challenge Events
  CHALLENGE_STARTED: 'challenge_started',
  CHALLENGE_COMPLETED: 'challenge_completed',
  CHALLENGE_ABANDONED: 'challenge_abandoned',
  HINT_USED: 'hint_used',

  // Invite Events
  INVITE_SENT: 'invite_sent',
  INVITE_ACCEPTED: 'invite_accepted',
  INVITE_COMPLETED: 'invite_completed',

  // Conversion Events
  REGISTRATION_STARTED: 'registration_started',
  REGISTRATION_COMPLETED: 'registration_completed',
  EMAIL_CAPTURED: 'email_captured',

  // Upsell Events
  UPSELL_VIDEO_SHOWN: 'upsell_video_shown',
  UPSELL_VIDEO_CLICKED: 'upsell_video_clicked',
  UPSELL_EXAM_SHOWN: 'upsell_exam_shown',
  UPSELL_EXAM_CLICKED: 'upsell_exam_clicked',

  // Subscription Events
  SUBSCRIPTION_STARTED: 'subscription_started',
  SUBSCRIPTION_CANCELLED: 'subscription_cancelled',
} as const;

// Track function with types
export function trackEvent(
  event: keyof typeof EVENTS,
  properties?: Record<string, unknown>
) {
  posthog.capture(EVENTS[event], {
    ...properties,
    timestamp: new Date().toISOString(),
  });
}

// Identify user
export function identifyUser(userId: string, traits?: Record<string, unknown>) {
  posthog.identify(userId, traits);
}

// Track page view
export function trackPageView(path: string) {
  posthog.capture('$pageview', { $current_url: path });
}

```

### 8.2 Error Tracking (Sentry)

```tsx
// lib/sentry.ts

import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
  tracesSampleRate: 0.1,

  beforeSend(event) {
    // Don't send in development
    if (process.env.NODE_ENV === 'development') {
      return null;
    }
    return event;
  },
});

export function captureError(error: Error, context?: Record<string, unknown>) {
  Sentry.captureException(error, {
    extra: context,
  });
}

```

---

## 9. Security Checklist

```markdown
## Security Implementation Checklist

### Authentication
- [x] Supabase Auth with RLS
- [x] Magic Link option (no passwords to store)
- [x] Session refresh on activity
- [x] Logout on suspicious activity

### Data Protection
- [x] Row Level Security on all tables
- [x] Input validation with Zod
- [x] SQL injection prevention (parameterized queries)
- [x] XSS prevention (React escaping + CSP)

### API Security
- [x] Rate limiting on submit endpoints
- [x] CORS configuration for embeds
- [x] Webhook signature verification (Stripe)
- [x] API key rotation capability

### Privacy
- [x] GDPR-compliant data handling
- [x] Email opt-in for marketing
- [x] Data export functionality
- [x] Account deletion option

### Infrastructure
- [x] HTTPS everywhere
- [x] Environment variable encryption
- [x] Database backups (Supabase)
- [x] DDoS protection (Vercel)

```

---

# Authentifizierung

# Authentifizierung & Integration mit WordPress/BuddyBoss/LearnDash

---

## 1. Aktuelle Situation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BESTEHENDES SYSTEM                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            WORDPRESS                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚  WordPress   â”‚    â”‚  BuddyBoss   â”‚    â”‚  LearnDash   â”‚                      â”‚
â”‚   â”‚    Users     â”‚    â”‚  (Community) â”‚    â”‚   (Kurse)    â”‚                      â”‚
â”‚   â”‚              â”‚    â”‚              â”‚    â”‚              â”‚                      â”‚
â”‚   â”‚  - Email     â”‚    â”‚  - Profile   â”‚    â”‚  - Enrolled  â”‚                      â”‚
â”‚   â”‚  - Password  â”‚    â”‚  - Groups    â”‚    â”‚  - Progress  â”‚                      â”‚
â”‚   â”‚  - Meta      â”‚    â”‚  - Activity  â”‚    â”‚  - Quizzes   â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚           â”‚                                       â”‚                              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                               â–¼                                                  â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚                    â”‚   WooCommerce    â”‚                                         â”‚
â”‚                    â”‚  Subscriptions   â”‚                                         â”‚
â”‚                    â”‚                  â”‚                                         â”‚
â”‚                    â”‚  - Monatsabo     â”‚                                         â”‚
â”‚                    â”‚  - Halbjahresabo â”‚                                         â”‚
â”‚                    â”‚  - Jahresabo     â”‚                                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

### Herausforderungen

| Aspekt | Problem |
| --- | --- |
| **User-Daten** | User sind in WordPress wp_users Tabelle |
| **Abos** | WooCommerce Subscriptions verwaltet Abos |
| **Kurse** | LearnDash speichert Fortschritt in WordPress |
| **Community** | BuddyBoss Profile, Gruppen, Activity |
| **Challenge Mode** | Soll auch fÃ¼r Nicht-WordPress-User funktionieren |

---

## 2. Auth-Strategien im Vergleich

### Option A: WordPress als Auth Master (SSO Bridge)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OPTION A: WORDPRESS ALS MASTER                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         WORDPRESS               â”‚
                    â”‚    (Auth Master / SSO IdP)      â”‚
                    â”‚                                 â”‚
                    â”‚  wp_users = Source of Truth     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                         JWT Token / SSO
                                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚                       â”‚
            â–¼                       â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Challenge   â”‚      â”‚   LearnDash   â”‚      â”‚   BuddyBoss   â”‚
    â”‚   (Next.js)   â”‚      â”‚    Kurse      â”‚      â”‚   Community   â”‚
    â”‚               â”‚      â”‚               â”‚      â”‚               â”‚
    â”‚ Supabase nur  â”‚      â”‚  Bleibt wie   â”‚      â”‚  Bleibt wie   â”‚
    â”‚ fÃ¼r Sessions  â”‚      â”‚    bisher     â”‚      â”‚    bisher     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FLOW FÃœR BESTEHENDE USER:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User  â”‚â”€â”€Loginâ”€â–¶â”‚WordPressâ”‚â”€â”€JWTâ”€â”€â”€â–¶â”‚Next.js â”‚â”€â”€Verifyâ”€â–¶â”‚Supabaseâ”‚
â”‚        â”‚         â”‚   SSO  â”‚         â”‚  API   â”‚         â”‚Session â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FLOW FÃœR NEUE USER (via Challenge):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User  â”‚â”€â”€Emailâ”€â–¶â”‚Next.js â”‚â”€â”€Createâ”€â–¶â”‚WordPressâ”‚â—€â”€Syncâ”€â”€â”‚Supabaseâ”‚
â”‚        â”‚         â”‚Registerâ”‚         â”‚  User  â”‚         â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**Vorteile:**

- âœ… Keine User-Migration nÃ¶tig
- âœ… Bestehende Abos, Kurse, Community bleiben intakt
- âœ… Schrittweise EinfÃ¼hrung mÃ¶glich

**Nachteile:**

- âŒ Komplexere Architektur (zwei Auth-Systeme)
- âŒ SSO-Implementation nÃ¶tig
- âŒ Latenz bei Auth-Checks

---

### Option B: Supabase als Auth Master (Vollmigration)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OPTION B: SUPABASE ALS MASTER                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          SUPABASE               â”‚
                    â”‚      (Auth Master)              â”‚
                    â”‚                                 â”‚
                    â”‚  auth.users = Source of Truth   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                              Supabase JWT
                                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚                       â”‚
            â–¼                       â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Challenge   â”‚      â”‚   WordPress   â”‚      â”‚   Neue App    â”‚
    â”‚   (Next.js)   â”‚      â”‚  (Headless)   â”‚      â”‚   (SpÃ¤ter)    â”‚
    â”‚               â”‚      â”‚               â”‚      â”‚               â”‚
    â”‚  Native Auth  â”‚      â”‚ Supabase Auth â”‚      â”‚  Native Auth  â”‚
    â”‚               â”‚      â”‚   Plugin      â”‚      â”‚               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

**Vorteile:**

- âœ… Ein einheitliches Auth-System
- âœ… Modernere Infrastruktur
- âœ… Einfachere Langzeit-Wartung

**Nachteile:**

- âŒ GroÃŸe Migration (User, Abos, PasswÃ¶rter)
- âŒ LearnDash/BuddyBoss Integration schwierig
- âŒ Risiko fÃ¼r bestehende User

---

### Option C: Hybrid (Empfohlen) â­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OPTION C: HYBRID (EMPFOHLEN)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PHASE 1: Challenge Mode Launch
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         WORDPRESS               â”‚         â”‚         CHALLENGE APP           â”‚
â”‚     (Bestehende User)           â”‚         â”‚        (Neue User)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚         â”‚                                 â”‚
â”‚  - Alle bestehenden User        â”‚   SSO   â”‚  - Unregistrierte Besucher      â”‚
â”‚  - LearnDash Kurse              â”‚â—€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  - Email Capture                â”‚
â”‚  - BuddyBoss Community          â”‚         â”‚  - Supabase Auth (neue User)    â”‚
â”‚  - WooCommerce Abos             â”‚         â”‚  - Challenge Sessions           â”‚
â”‚                                 â”‚         â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â”‚                                              â”‚
         â”‚                                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚    SHARED DATA      â”‚
                 â”‚                     â”‚
                 â”‚  - User Mapping     â”‚
                 â”‚  - Abo Status       â”‚
                 â”‚  - Challenge Stats  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PHASE 2: Graduelle Migration (6-12 Monate spÃ¤ter)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          SUPABASE               â”‚
                    â”‚      (Wird Auth Master)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                       â”‚                       â”‚
            â–¼                       â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Challenge   â”‚      â”‚   Neue Kurse  â”‚      â”‚  WordPress    â”‚
    â”‚               â”‚      â”‚   (Next.js)   â”‚      â”‚  (Blog only)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---



```sql
-- Erweiterung des Supabase Schemas fÃ¼r WordPress-Integration

-- User Mapping Tabelle
CREATE TABLE user_mappings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Supabase User
    supabase_user_id UUID REFERENCES auth.users(id),

    -- WordPress User
    wordpress_user_id BIGINT,
    wordpress_site_url TEXT DEFAULT 'https://gogymi.ch',

    -- Sync Status
    sync_status TEXT DEFAULT 'pending', -- 'pending', 'synced', 'conflict'
    last_synced_at TIMESTAMPTZ,

    -- Origin
    created_from TEXT NOT NULL, -- 'wordpress', 'challenge', 'manual'

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(supabase_user_id),
    UNIQUE(wordpress_user_id, wordpress_site_url)
);

-- WordPress Subscription Cache
CREATE TABLE wordpress_subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_mapping_id UUID REFERENCES user_mappings(id),

    -- WooCommerce Data
    wc_subscription_id BIGINT,
    wc_product_id BIGINT,
    product_name TEXT, -- 'Monatsabo', 'Jahresabo', etc.

    -- Status
    status TEXT, -- 'active', 'cancelled', 'expired', 'pending'

    -- Dates
    start_date TIMESTAMPTZ,
    end_date TIMESTAMPTZ,
    next_payment_date TIMESTAMPTZ,

    -- Cache
    last_synced_at TIMESTAMPTZ DEFAULT NOW(),
    raw_data JSONB, -- Full WooCommerce response

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Funktion: Check if user has active subscription
CREATE OR REPLACE FUNCTION check_subscription_status(p_supabase_user_id UUID)
RETURNS TABLE (
    has_active_sub BOOLEAN,
    subscription_tier TEXT,
    expires_at TIMESTAMPTZ,
    source TEXT -- 'supabase' oder 'wordpress'
) AS $$
BEGIN
    -- First check Supabase subscriptions (new system)
    RETURN QUERY
    SELECT
        TRUE,
        s.tier::TEXT,
        s.ends_at,
        'supabase'::TEXT
    FROM subscriptions s
    WHERE s.user_id = p_supabase_user_id
      AND s.status = 'active'
      AND (s.ends_at IS NULL OR s.ends_at > NOW())
    LIMIT 1;

    IF NOT FOUND THEN
        -- Check WordPress subscriptions (legacy)
        RETURN QUERY
        SELECT
            TRUE,
            ws.product_name,
            ws.end_date,
            'wordpress'::TEXT
        FROM wordpress_subscriptions ws
        JOIN user_mappings um ON ws.user_mapping_id = um.id
        WHERE um.supabase_user_id = p_supabase_user_id
          AND ws.status = 'active'
          AND (ws.end_date IS NULL OR ws.end_date > NOW())
        LIMIT 1;
    END IF;

    IF NOT FOUND THEN
        -- No subscription found
        RETURN QUERY SELECT FALSE, 'free'::TEXT, NULL::TIMESTAMPTZ, NULL::TEXT;
    END IF;
END;
$$ LANGUAGE plpgsql;

```



```tsx
// hooks/use-wordpress-sso.ts

import { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';

declare global {
  interface Window {
    GoGymiWPUser?: {
      id: number;
      email: string;
      name: string;
      ssoEndpoint: string;
      nonce: string;
    };
  }
}

export function useWordPressSSO() {
  const [isWordPressUser, setIsWordPressUser] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const router = useRouter();

  useEffect(() => {
    // Check if we're in a WordPress context
    if (typeof window !== 'undefined' && window.GoGymiWPUser) {
      setIsWordPressUser(true);
    }
  }, []);

  const loginWithWordPress = async (returnUrl?: string) => {
    if (!window.GoGymiWPUser) {
      throw new Error('Not in WordPress context');
    }

    setIsLoading(true);

    try {
      // Get SSO token from WordPress
      const response = await fetch(window.GoGymiWPUser.ssoEndpoint, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-WP-Nonce': window.GoGymiWPUser.nonce,
        },
        credentials: 'include',
      });

      if (!response.ok) {
        throw new Error('Failed to get SSO token');
      }

      const { redirect_url } = await response.json();

      // Add return URL
      const url = new URL(redirect_url);
      if (returnUrl) {
        url.searchParams.set('returnUrl', returnUrl);
      }

      // Redirect to SSO
      window.location.href = url.toString();

    } catch (error) {
      setIsLoading(false);
      throw error;
    }
  };

  return {
    isWordPressUser,
    isLoading,
    loginWithWordPress,
  };
}

```

---

## 4. Subscription Check Middleware

```tsx
// middleware.ts

import { createMiddlewareClient } from '@supabase/auth-helpers-nextjs';
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

// Routes that require subscription
const PREMIUM_ROUTES = [
  '/dashboard/exams',
  '/dashboard/videos',
  '/api/exams',
  '/api/videos/full',
];

// Routes that require auth but not subscription
const AUTH_ROUTES = [
  '/dashboard',
  '/challenges/history',
  '/profile',
];

export async function middleware(request: NextRequest) {
  const res = NextResponse.next();
  const supabase = createMiddlewareClient({ req: request, res });

  const { data: { session } } = await supabase.auth.getSession();

  const path = request.nextUrl.pathname;

  // Check if route requires auth
  const requiresAuth = AUTH_ROUTES.some(route => path.startsWith(route)) ||
                       PREMIUM_ROUTES.some(route => path.startsWith(route));

  if (requiresAuth && !session) {
    return NextResponse.redirect(new URL('/login', request.url));
  }

  // Check if route requires subscription
  const requiresSubscription = PREMIUM_ROUTES.some(route => path.startsWith(route));

  if (requiresSubscription && session) {
    // Check subscription status
    const { data: subStatus } = await supabase
      .rpc('check_subscription_status', {
        p_supabase_user_id: session.user.id,
      })
      .single();

    if (!subStatus?.has_active_sub) {
      // Redirect to upsell page
      return NextResponse.redirect(
        new URL('/upgrade?reason=subscription_required', request.url)
      );
    }
  }

  return res;
}

export const config = {
  matcher: [
    '/dashboard/:path*',
    '/challenges/:path*',
    '/profile/:path*',
    '/api/exams/:path*',
    '/api/videos/:path*',
  ],
};

```

---

## 5. Zusammenfassung: Auth-Flow Ãœbersicht

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          KOMPLETTER AUTH-FLOW                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   Besucher  â”‚
                                    â”‚   kommt an  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  Hat WordPress Cookie? â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ JA                                â”‚ NEIN
                         â–¼                                   â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚  Auto-SSO via   â”‚                 â”‚   Visitor ID    â”‚
               â”‚  WordPress JWT  â”‚                 â”‚   (Cookie)      â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                                   â”‚
                        â–¼                                   â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ Supabase Sessionâ”‚                 â”‚ Challenge als   â”‚
               â”‚   erstellt      â”‚                 â”‚    Gast         â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                                   â”‚
                        â”‚                          Nach 1. Aufgabe
                        â”‚                                   â”‚
                        â”‚                                   â–¼
                        â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                          â”‚  Email Capture  â”‚
                        â”‚                          â”‚     Gate        â”‚
                        â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                                   â”‚
                        â”‚                                   â–¼
                        â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                          â”‚ Magic Link Auth â”‚
                        â”‚                          â”‚  (Supabase)     â”‚
                        â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                                   â”‚
                        â”‚                                   â–¼
                        â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                          â”‚ WordPress User  â”‚
                        â”‚                          â”‚   erstellen     â”‚
                        â”‚                          â”‚   (Webhook)     â”‚
                        â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚                                   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚   Dashboard     â”‚
                               â”‚   Challenges    â”‚
                               â”‚   Stats         â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                   Abo kaufen?
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  WooCommerce    â”‚
                               â”‚  Checkout       â”‚
                               â”‚  (WordPress)    â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                   Webhook
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  Subscription   â”‚
                               â”‚  in Supabase    â”‚
                               â”‚  aktualisiert   â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## 6. Empfohlene Migrations-Roadmap

| Phase | Zeitraum | Aktion |
| --- | --- | --- |
| **Phase 1** |  | WordPress SSO Plugin installieren, JWT Secret konfigurieren |
| **Phase 2** |  | Challenge App mit SSO-Handler deployen |
| **Phase 3** |  | User Mapping Tabelle fÃ¼llen (bestehende User) |
| **Phase 4** |  | WooCommerce Webhooks aktivieren |
| **Phase 5** |  | Testing mit Beta-Usern |
| **Phase 6** |  | Graduelle Migration von Features |

---


# Timeline & Milestones

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DEVELOPMENT TIMELINE                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Foundation
â”œâ”€â”€ [ ] Project setup (Next.js, Supabase, Vercel)
â”œâ”€â”€ [ ] Database schema & migrations
â”œâ”€â”€ [ ] Basic auth flow
â””â”€â”€ [ ] Task import from existing system

Core Challenge
â”œâ”€â”€ [ ] Task display component
â”œâ”€â”€ [ ] Answer input components (all types)
â”œâ”€â”€ [ ] Timer functionality
â”œâ”€â”€ [ ] Submit & validation logic
â””â”€â”€ [ ] Result screen with animations

Gamification
â”œâ”€â”€ [ ] XP calculation
â”œâ”€â”€ [ ] Streak tracking
â”œâ”€â”€ [ ] Badge system
â”œâ”€â”€ [ ] Leaderboard

Social Features
â”œâ”€â”€ [ ] Challenge invite flow
â”œâ”€â”€ [ ] Email templates (Resend)
â”œâ”€â”€ [ ] Duell result screen
â”œâ”€â”€ [ ] Share functionality

Integration
â”œâ”€â”€ [ ] WordPress shortcode plugin
â”œâ”€â”€ [ ] Embed version for media
â”œâ”€â”€ [ ] Analytics setup (PostHog)
â””â”€â”€ [ ] Stripe integration

Polish & Launch
â”œâ”€â”€ [ ] Bug fixes
â”œâ”€â”€ [ ] Performance optimization
â”œâ”€â”€ [ ] Beta testing with schools
â””â”€â”€ [ ] Production deployment

POST-LAUNCH
â”œâ”€â”€ [ ] A/B testing upsell flows
â”œâ”€â”€ [ ] Realtime leaderboard
â”œâ”€â”€ [ ] Daily challenge feature
â””â”€â”€ [ ] Mobile app (PWA)

```